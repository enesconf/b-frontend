import{r as g,g as di,R as C,j as A,b as hi,u as mi}from"./index-CccsQzu4.js";import{q as at,_ as ct,p as We,F as gi,L as Vt,a as Bt}from"./project-DDtakXrc.js";function pi({title:e,titleId:t,...n},r){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const yi=g.forwardRef(pi);function xi({title:e,titleId:t,...n},r){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const wi=g.forwardRef(xi);function vi({title:e,titleId:t,...n},r){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"}))}const bi=g.forwardRef(vi);function _i({title:e,titleId:t,...n},r){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5"}))}const Ei=g.forwardRef(_i);function Si({title:e,titleId:t,...n},r){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const bn=g.forwardRef(Si);function Ni({title:e,titleId:t,...n},r){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?g.createElement("title",{id:t},e):null,g.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Ai=g.forwardRef(Ni);function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ie(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var io={exports:{}},ao={},co={exports:{}},lo={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ht=g;function Ci(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ki=typeof Object.is=="function"?Object.is:Ci,$i=ht.useState,Mi=ht.useEffect,Ti=ht.useLayoutEffect,Ri=ht.useDebugValue;function zi(e,t){var n=t(),r=$i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return Ti(function(){o.value=n,o.getSnapshot=t,_n(o)&&i({inst:o})},[e,n,t]),Mi(function(){return _n(o)&&i({inst:o}),e(function(){_n(o)&&i({inst:o})})},[e]),Ri(n),n}function _n(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ki(e,n)}catch{return!0}}function Di(e,t){return t()}var Ii=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Di:zi;lo.useSyncExternalStore=ht.useSyncExternalStore!==void 0?ht.useSyncExternalStore:Ii;co.exports=lo;var Pi=co.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fn=g,Hi=Pi;function Fi(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Li=typeof Object.is=="function"?Object.is:Fi,ji=Hi.useSyncExternalStore,Vi=fn.useRef,Bi=fn.useEffect,Oi=fn.useMemo,qi=fn.useDebugValue;ao.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=Vi(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=Oi(function(){function c(m){if(!u){if(u=!0,l=m,m=r(m),o!==void 0&&s.hasValue){var w=s.value;if(o(w,m))return f=w}return f=m}if(w=f,Li(l,m))return w;var y=r(m);return o!==void 0&&o(w,y)?w:(l=m,f=y)}var u=!1,l,f,h=n===void 0?null:n;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,n,r,o]);var a=ji(e,i[0],i[1]);return Bi(function(){s.hasValue=!0,s.value=a},[a]),qi(a),a};io.exports=ao;var Xi=io.exports;const Yi=di(Xi),Ui={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://api.videomatik.com"},pr=e=>{let t;const n=new Set,r=(l,f)=>{const h=typeof l=="function"?l(t):l;if(!Object.is(h,t)){const m=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(w=>w(t,m))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>u,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{(Ui?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,o,c);return c},Wi=e=>e?pr(e):pr,{useDebugValue:Zi}=C,{useSyncExternalStoreWithSelector:Gi}=Yi,Ki=e=>e;function uo(e,t=Ki,n){const r=Gi(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Zi(r),r}const yr=(e,t)=>{const n=Wi(e),r=(o,i=t)=>uo(n,o,i);return Object.assign(r,n),r},Qi=(e,t)=>e?yr(e,t):yr;function se(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Ji={value:()=>{}};function dn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Qt(n)}function Qt(e){this._=e}function ea(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Qt.prototype=dn.prototype={constructor:Qt,on:function(e,t){var n=this._,r=ea(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=ta(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=xr(n[o],e.name,t);else if(t==null)for(o in n)n[o]=xr(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Qt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function ta(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function xr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Ji,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Rn="http://www.w3.org/1999/xhtml";const wr={svg:"http://www.w3.org/2000/svg",xhtml:Rn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function hn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),wr.hasOwnProperty(t)?{space:wr[t],local:e}:e}function na(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Rn&&t.documentElement.namespaceURI===Rn?t.createElement(e):t.createElementNS(n,e)}}function ra(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function fo(e){var t=hn(e);return(t.local?ra:na)(t)}function oa(){}function Wn(e){return e==null?oa:function(){return this.querySelector(e)}}function sa(e){typeof e!="function"&&(e=Wn(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),c,u,l=0;l<s;++l)(c=i[l])&&(u=e.call(c,c.__data__,l,i))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new le(r,this._parents)}function ia(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function aa(){return[]}function ho(e){return e==null?aa:function(){return this.querySelectorAll(e)}}function ca(e){return function(){return ia(e.apply(this,arguments))}}function la(e){typeof e=="function"?e=ca(e):e=ho(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(r.push(e.call(c,c.__data__,u,s)),o.push(c));return new le(r,o)}function mo(e){return function(){return this.matches(e)}}function go(e){return function(t){return t.matches(e)}}var ua=Array.prototype.find;function fa(e){return function(){return ua.call(this.children,e)}}function da(){return this.firstElementChild}function ha(e){return this.select(e==null?da:fa(typeof e=="function"?e:go(e)))}var ma=Array.prototype.filter;function ga(){return Array.from(this.children)}function pa(e){return function(){return ma.call(this.children,e)}}function ya(e){return this.selectAll(e==null?ga:pa(typeof e=="function"?e:go(e)))}function xa(e){typeof e!="function"&&(e=mo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new le(r,this._parents)}function po(e){return new Array(e.length)}function wa(){return new le(this._enter||this._groups.map(po),this._parents)}function nn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}nn.prototype={constructor:nn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function va(e){return function(){return e}}function ba(e,t,n,r,o,i){for(var s=0,a,c=t.length,u=i.length;s<u;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new nn(e,i[s]);for(;s<c;++s)(a=t[s])&&(o[s]=a)}function _a(e,t,n,r,o,i,s){var a,c,u=new Map,l=t.length,f=i.length,h=new Array(l),m;for(a=0;a<l;++a)(c=t[a])&&(h[a]=m=s.call(c,c.__data__,a,t)+"",u.has(m)?o[a]=c:u.set(m,c));for(a=0;a<f;++a)m=s.call(e,i[a],a,i)+"",(c=u.get(m))?(r[a]=c,c.__data__=i[a],u.delete(m)):n[a]=new nn(e,i[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(h[a])===c&&(o[a]=c)}function Ea(e){return e.__data__}function Sa(e,t){if(!arguments.length)return Array.from(this,Ea);var n=t?_a:ba,r=this._parents,o=this._groups;typeof e!="function"&&(e=va(e));for(var i=o.length,s=new Array(i),a=new Array(i),c=new Array(i),u=0;u<i;++u){var l=r[u],f=o[u],h=f.length,m=Na(e.call(l,l&&l.__data__,u,r)),w=m.length,y=a[u]=new Array(w),E=s[u]=new Array(w),p=c[u]=new Array(h);n(l,f,y,E,p,m,t);for(var S=0,v=0,x,T;S<w;++S)if(x=y[S]){for(S>=v&&(v=S+1);!(T=E[v])&&++v<w;);x._next=T||null}}return s=new le(s,r),s._enter=a,s._exit=c,s}function Na(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Aa(){return new le(this._exit||this._groups.map(po),this._parents)}function Ca(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function ka(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),c=0;c<s;++c)for(var u=n[c],l=r[c],f=u.length,h=a[c]=new Array(f),m,w=0;w<f;++w)(m=u[w]||l[w])&&(h[w]=m);for(;c<o;++c)a[c]=n[c];return new le(a,this._parents)}function $a(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Ma(e){e||(e=Ta);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,c=o[i]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(t)}return new le(o,this._parents).order()}function Ta(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ra(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function za(){return Array.from(this)}function Da(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Ia(){let e=0;for(const t of this)++e;return e}function Pa(){return!this.node()}function Ha(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function Fa(e){return function(){this.removeAttribute(e)}}function La(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ja(e,t){return function(){this.setAttribute(e,t)}}function Va(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ba(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Oa(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function qa(e,t){var n=hn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?La:Fa:typeof t=="function"?n.local?Oa:Ba:n.local?Va:ja)(n,t))}function yo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Xa(e){return function(){this.style.removeProperty(e)}}function Ya(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ua(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Wa(e,t,n){return arguments.length>1?this.each((t==null?Xa:typeof t=="function"?Ua:Ya)(e,t,n??"")):mt(this.node(),e)}function mt(e,t){return e.style.getPropertyValue(t)||yo(e).getComputedStyle(e,null).getPropertyValue(t)}function Za(e){return function(){delete this[e]}}function Ga(e,t){return function(){this[e]=t}}function Ka(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Qa(e,t){return arguments.length>1?this.each((t==null?Za:typeof t=="function"?Ka:Ga)(e,t)):this.node()[e]}function xo(e){return e.trim().split(/^|\s+/)}function Zn(e){return e.classList||new wo(e)}function wo(e){this._node=e,this._names=xo(e.getAttribute("class")||"")}wo.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function vo(e,t){for(var n=Zn(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function bo(e,t){for(var n=Zn(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Ja(e){return function(){vo(this,e)}}function ec(e){return function(){bo(this,e)}}function tc(e,t){return function(){(t.apply(this,arguments)?vo:bo)(this,e)}}function nc(e,t){var n=xo(e+"");if(arguments.length<2){for(var r=Zn(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?tc:t?Ja:ec)(n,t))}function rc(){this.textContent=""}function oc(e){return function(){this.textContent=e}}function sc(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ic(e){return arguments.length?this.each(e==null?rc:(typeof e=="function"?sc:oc)(e)):this.node().textContent}function ac(){this.innerHTML=""}function cc(e){return function(){this.innerHTML=e}}function lc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function uc(e){return arguments.length?this.each(e==null?ac:(typeof e=="function"?lc:cc)(e)):this.node().innerHTML}function fc(){this.nextSibling&&this.parentNode.appendChild(this)}function dc(){return this.each(fc)}function hc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function mc(){return this.each(hc)}function gc(e){var t=typeof e=="function"?e:fo(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function pc(){return null}function yc(e,t){var n=typeof e=="function"?e:fo(e),r=t==null?pc:typeof t=="function"?t:Wn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function xc(){var e=this.parentNode;e&&e.removeChild(this)}function wc(){return this.each(xc)}function vc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function bc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function _c(e){return this.select(e?bc:vc)}function Ec(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Sc(e){return function(t){e.call(this,t,this.__data__)}}function Nc(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Ac(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Cc(e,t,n){return function(){var r=this.__on,o,i=Sc(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function kc(e,t,n){var r=Nc(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(o=0,l=a[c];o<i;++o)if((s=r[o]).type===l.type&&s.name===l.name)return l.value}return}for(a=t?Cc:Ac,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function _o(e,t,n){var r=yo(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function $c(e,t){return function(){return _o(this,e,t)}}function Mc(e,t){return function(){return _o(this,e,t.apply(this,arguments))}}function Tc(e,t){return this.each((typeof t=="function"?Mc:$c)(e,t))}function*Rc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var Eo=[null];function le(e,t){this._groups=e,this._parents=t}function Ft(){return new le([[document.documentElement]],Eo)}function zc(){return this}le.prototype=Ft.prototype={constructor:le,select:sa,selectAll:la,selectChild:ha,selectChildren:ya,filter:xa,data:Sa,enter:wa,exit:Aa,join:Ca,merge:ka,selection:zc,order:$a,sort:Ma,call:Ra,nodes:za,node:Da,size:Ia,empty:Pa,each:Ha,attr:qa,style:Wa,property:Qa,classed:nc,text:ic,html:uc,raise:dc,lower:mc,append:gc,insert:yc,remove:wc,clone:_c,datum:Ec,on:kc,dispatch:Tc,[Symbol.iterator]:Rc};function pe(e){return typeof e=="string"?new le([[document.querySelector(e)]],[document.documentElement]):new le([[e]],Eo)}function Dc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function _e(e,t){if(e=Dc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ic={passive:!1},Tt={capture:!0,passive:!1};function En(e){e.stopImmediatePropagation()}function lt(e){e.preventDefault(),e.stopImmediatePropagation()}function So(e){var t=e.document.documentElement,n=pe(e).on("dragstart.drag",lt,Tt);"onselectstart"in t?n.on("selectstart.drag",lt,Tt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function No(e,t){var n=e.document.documentElement,r=pe(e).on("dragstart.drag",null);t&&(r.on("click.drag",lt,Tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ot=e=>()=>e;function zn(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}zn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Pc(e){return!e.ctrlKey&&!e.button}function Hc(){return this.parentNode}function Fc(e,t){return t??{x:e.x,y:e.y}}function Lc(){return navigator.maxTouchPoints||"ontouchstart"in this}function jc(){var e=Pc,t=Hc,n=Fc,r=Lc,o={},i=dn("start","drag","end"),s=0,a,c,u,l,f=0;function h(x){x.on("mousedown.drag",m).filter(r).on("touchstart.drag",E).on("touchmove.drag",p,Ic).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(x,T){if(!(l||!e.call(this,x,T))){var H=v(this,t.call(this,x,T),x,T,"mouse");H&&(pe(x.view).on("mousemove.drag",w,Tt).on("mouseup.drag",y,Tt),So(x.view),En(x),u=!1,a=x.clientX,c=x.clientY,H("start",x))}}function w(x){if(lt(x),!u){var T=x.clientX-a,H=x.clientY-c;u=T*T+H*H>f}o.mouse("drag",x)}function y(x){pe(x.view).on("mousemove.drag mouseup.drag",null),No(x.view,u),lt(x),o.mouse("end",x)}function E(x,T){if(e.call(this,x,T)){var H=x.changedTouches,L=t.call(this,x,T),j=H.length,z,V;for(z=0;z<j;++z)(V=v(this,L,x,T,H[z].identifier,H[z]))&&(En(x),V("start",x,H[z]))}}function p(x){var T=x.changedTouches,H=T.length,L,j;for(L=0;L<H;++L)(j=o[T[L].identifier])&&(lt(x),j("drag",x,T[L]))}function S(x){var T=x.changedTouches,H=T.length,L,j;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),L=0;L<H;++L)(j=o[T[L].identifier])&&(En(x),j("end",x,T[L]))}function v(x,T,H,L,j,z){var V=i.copy(),k=_e(z||H,T),F,I,d;if((d=n.call(x,new zn("beforestart",{sourceEvent:H,target:h,identifier:j,active:s,x:k[0],y:k[1],dx:0,dy:0,dispatch:V}),L))!=null)return F=d.x-k[0]||0,I=d.y-k[1]||0,function N(b,$,D){var _=k,M;switch(b){case"start":o[j]=N,M=s++;break;case"end":delete o[j],--s;case"drag":k=_e(D||$,T),M=s;break}V.call(b,x,new zn(b,{sourceEvent:$,subject:d,target:h,identifier:j,active:M,x:k[0]+F,y:k[1]+I,dx:k[0]-_[0],dy:k[1]-_[1],dispatch:V}),L)}}return h.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Ot(!!x),h):e},h.container=function(x){return arguments.length?(t=typeof x=="function"?x:Ot(x),h):t},h.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Ot(x),h):n},h.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Ot(!!x),h):r},h.on=function(){var x=i.on.apply(i,arguments);return x===i?h:x},h.clickDistance=function(x){return arguments.length?(f=(x=+x)*x,h):Math.sqrt(f)},h}function Gn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ao(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Lt(){}var Rt=.7,rn=1/Rt,ut="\\s*([+-]?\\d+)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ee="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Vc=/^#([0-9a-f]{3,8})$/,Bc=new RegExp(`^rgb\\(${ut},${ut},${ut}\\)$`),Oc=new RegExp(`^rgb\\(${Ee},${Ee},${Ee}\\)$`),qc=new RegExp(`^rgba\\(${ut},${ut},${ut},${zt}\\)$`),Xc=new RegExp(`^rgba\\(${Ee},${Ee},${Ee},${zt}\\)$`),Yc=new RegExp(`^hsl\\(${zt},${Ee},${Ee}\\)$`),Uc=new RegExp(`^hsla\\(${zt},${Ee},${Ee},${zt}\\)$`),vr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gn(Lt,Dt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:br,formatHex:br,formatHex8:Wc,formatHsl:Zc,formatRgb:_r,toString:_r});function br(){return this.rgb().formatHex()}function Wc(){return this.rgb().formatHex8()}function Zc(){return Co(this).formatHsl()}function _r(){return this.rgb().formatRgb()}function Dt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Vc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Er(t):n===3?new ae(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?qt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?qt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Bc.exec(e))?new ae(t[1],t[2],t[3],1):(t=Oc.exec(e))?new ae(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qc.exec(e))?qt(t[1],t[2],t[3],t[4]):(t=Xc.exec(e))?qt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Yc.exec(e))?Ar(t[1],t[2]/100,t[3]/100,1):(t=Uc.exec(e))?Ar(t[1],t[2]/100,t[3]/100,t[4]):vr.hasOwnProperty(e)?Er(vr[e]):e==="transparent"?new ae(NaN,NaN,NaN,0):null}function Er(e){return new ae(e>>16&255,e>>8&255,e&255,1)}function qt(e,t,n,r){return r<=0&&(e=t=n=NaN),new ae(e,t,n,r)}function Gc(e){return e instanceof Lt||(e=Dt(e)),e?(e=e.rgb(),new ae(e.r,e.g,e.b,e.opacity)):new ae}function Dn(e,t,n,r){return arguments.length===1?Gc(e):new ae(e,t,n,r??1)}function ae(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Gn(ae,Dn,Ao(Lt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Rt:Math.pow(Rt,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ae(Ze(this.r),Ze(this.g),Ze(this.b),on(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Sr,formatHex:Sr,formatHex8:Kc,formatRgb:Nr,toString:Nr}));function Sr(){return`#${Ye(this.r)}${Ye(this.g)}${Ye(this.b)}`}function Kc(){return`#${Ye(this.r)}${Ye(this.g)}${Ye(this.b)}${Ye((isNaN(this.opacity)?1:this.opacity)*255)}`}function Nr(){const e=on(this.opacity);return`${e===1?"rgb(":"rgba("}${Ze(this.r)}, ${Ze(this.g)}, ${Ze(this.b)}${e===1?")":`, ${e})`}`}function on(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ze(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ye(e){return e=Ze(e),(e<16?"0":"")+e.toString(16)}function Ar(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ye(e,t,n,r)}function Co(e){if(e instanceof ye)return new ye(e.h,e.s,e.l,e.opacity);if(e instanceof Lt||(e=Dt(e)),!e)return new ye;if(e instanceof ye)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,c=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=c<.5?i+o:2-i-o,s*=60):a=c>0&&c<1?0:s,new ye(s,a,c,e.opacity)}function Qc(e,t,n,r){return arguments.length===1?Co(e):new ye(e,t,n,r??1)}function ye(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Gn(ye,Qc,Ao(Lt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new ye(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Rt:Math.pow(Rt,e),new ye(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new ae(Sn(e>=240?e-240:e+120,o,r),Sn(e,o,r),Sn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new ye(Cr(this.h),Xt(this.s),Xt(this.l),on(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=on(this.opacity);return`${e===1?"hsl(":"hsla("}${Cr(this.h)}, ${Xt(this.s)*100}%, ${Xt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Cr(e){return e=(e||0)%360,e<0?e+360:e}function Xt(e){return Math.max(0,Math.min(1,e||0))}function Sn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ko=e=>()=>e;function Jc(e,t){return function(n){return e+n*t}}function el(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function tl(e){return(e=+e)==1?$o:function(t,n){return n-t?el(t,n,e):ko(isNaN(t)?n:t)}}function $o(e,t){var n=t-e;return n?Jc(e,n):ko(isNaN(e)?t:e)}const kr=function e(t){var n=tl(t);function r(o,i){var s=n((o=Dn(o)).r,(i=Dn(i)).r),a=n(o.g,i.g),c=n(o.b,i.b),u=$o(o.opacity,i.opacity);return function(l){return o.r=s(l),o.g=a(l),o.b=c(l),o.opacity=u(l),o+""}}return r.gamma=e,r}(1);function Re(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var In=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Nn=new RegExp(In.source,"g");function nl(e){return function(){return e}}function rl(e){return function(t){return e(t)+""}}function ol(e,t){var n=In.lastIndex=Nn.lastIndex=0,r,o,i,s=-1,a=[],c=[];for(e=e+"",t=t+"";(r=In.exec(e))&&(o=Nn.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,c.push({i:s,x:Re(r,o)})),n=Nn.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?rl(c[0].x):nl(t):(t=c.length,function(u){for(var l=0,f;l<t;++l)a[(f=c[l]).i]=f.x(u);return a.join("")})}var $r=180/Math.PI,Pn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Mo(e,t,n,r,o,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*$r,skewX:Math.atan(c)*$r,scaleX:s,scaleY:a}}var Yt;function sl(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Pn:Mo(t.a,t.b,t.c,t.d,t.e,t.f)}function il(e){return e==null||(Yt||(Yt=document.createElementNS("http://www.w3.org/2000/svg","g")),Yt.setAttribute("transform",e),!(e=Yt.transform.baseVal.consolidate()))?Pn:(e=e.matrix,Mo(e.a,e.b,e.c,e.d,e.e,e.f))}function To(e,t,n,r){function o(u){return u.length?u.pop()+" ":""}function i(u,l,f,h,m,w){if(u!==f||l!==h){var y=m.push("translate(",null,t,null,n);w.push({i:y-4,x:Re(u,f)},{i:y-2,x:Re(l,h)})}else(f||h)&&m.push("translate("+f+t+h+n)}function s(u,l,f,h){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),h.push({i:f.push(o(f)+"rotate(",null,r)-2,x:Re(u,l)})):l&&f.push(o(f)+"rotate("+l+r)}function a(u,l,f,h){u!==l?h.push({i:f.push(o(f)+"skewX(",null,r)-2,x:Re(u,l)}):l&&f.push(o(f)+"skewX("+l+r)}function c(u,l,f,h,m,w){if(u!==f||l!==h){var y=m.push(o(m)+"scale(",null,",",null,")");w.push({i:y-4,x:Re(u,f)},{i:y-2,x:Re(l,h)})}else(f!==1||h!==1)&&m.push(o(m)+"scale("+f+","+h+")")}return function(u,l){var f=[],h=[];return u=e(u),l=e(l),i(u.translateX,u.translateY,l.translateX,l.translateY,f,h),s(u.rotate,l.rotate,f,h),a(u.skewX,l.skewX,f,h),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,f,h),u=l=null,function(m){for(var w=-1,y=h.length,E;++w<y;)f[(E=h[w]).i]=E.x(m);return f.join("")}}}var al=To(sl,"px, ","px)","deg)"),cl=To(il,", ",")",")"),ll=1e-12;function Mr(e){return((e=Math.exp(e))+1/e)/2}function ul(e){return((e=Math.exp(e))-1/e)/2}function fl(e){return((e=Math.exp(2*e))-1)/(e+1)}const dl=function e(t,n,r){function o(i,s){var a=i[0],c=i[1],u=i[2],l=s[0],f=s[1],h=s[2],m=l-a,w=f-c,y=m*m+w*w,E,p;if(y<ll)p=Math.log(h/u)/t,E=function(L){return[a+L*m,c+L*w,u*Math.exp(t*L*p)]};else{var S=Math.sqrt(y),v=(h*h-u*u+r*y)/(2*u*n*S),x=(h*h-u*u-r*y)/(2*h*n*S),T=Math.log(Math.sqrt(v*v+1)-v),H=Math.log(Math.sqrt(x*x+1)-x);p=(H-T)/t,E=function(L){var j=L*p,z=Mr(T),V=u/(n*S)*(z*fl(t*j+T)-ul(T));return[a+V*m,c+V*w,u*z/Mr(t*j+T)]}}return E.duration=p*1e3*t/Math.SQRT2,E}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},o}(Math.SQRT2,2,4);var gt=0,kt=0,Et=0,Ro=1e3,sn,$t,an=0,Ge=0,mn=0,It=typeof performance=="object"&&performance.now?performance:Date,zo=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Kn(){return Ge||(zo(hl),Ge=It.now()+mn)}function hl(){Ge=0}function cn(){this._call=this._time=this._next=null}cn.prototype=Do.prototype={constructor:cn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Kn():+n)+(t==null?0:+t),!this._next&&$t!==this&&($t?$t._next=this:sn=this,$t=this),this._call=e,this._time=n,Hn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Hn())}};function Do(e,t,n){var r=new cn;return r.restart(e,t,n),r}function ml(){Kn(),++gt;for(var e=sn,t;e;)(t=Ge-e._time)>=0&&e._call.call(void 0,t),e=e._next;--gt}function Tr(){Ge=(an=It.now())+mn,gt=kt=0;try{ml()}finally{gt=0,pl(),Ge=0}}function gl(){var e=It.now(),t=e-an;t>Ro&&(mn-=t,an=e)}function pl(){for(var e,t=sn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:sn=n);$t=e,Hn(r)}function Hn(e){if(!gt){kt&&(kt=clearTimeout(kt));var t=e-Ge;t>24?(e<1/0&&(kt=setTimeout(Tr,e-It.now()-mn)),Et&&(Et=clearInterval(Et))):(Et||(an=It.now(),Et=setInterval(gl,Ro)),gt=1,zo(Tr))}}function Rr(e,t,n){var r=new cn;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var yl=dn("start","end","cancel","interrupt"),xl=[],Io=0,zr=1,Fn=2,Jt=3,Dr=4,Ln=5,en=6;function gn(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;wl(e,n,{name:t,index:r,group:o,on:yl,tween:xl,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Io})}function Qn(e,t){var n=we(e,t);if(n.state>Io)throw new Error("too late; already scheduled");return n}function Se(e,t){var n=we(e,t);if(n.state>Jt)throw new Error("too late; already running");return n}function we(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function wl(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=Do(i,0,n.time);function i(u){n.state=zr,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var l,f,h,m;if(n.state!==zr)return c();for(l in r)if(m=r[l],m.name===n.name){if(m.state===Jt)return Rr(s);m.state===Dr?(m.state=en,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[l]):+l<t&&(m.state=en,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[l])}if(Rr(function(){n.state===Jt&&(n.state=Dr,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Fn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Fn){for(n.state=Jt,o=new Array(h=n.tween.length),l=0,f=-1;l<h;++l)(m=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=m);o.length=f+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Ln,1),f=-1,h=o.length;++f<h;)o[f].call(e,l);n.state===Ln&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=en,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function tn(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>Fn&&r.state<Ln,r.state=en,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function vl(e){return this.each(function(){tn(this,e)})}function bl(e,t){var n,r;return function(){var o=Se(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function _l(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=Se(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},c=0,u=o.length;c<u;++c)if(o[c].name===t){o[c]=a;break}c===u&&o.push(a)}i.tween=o}}function El(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=we(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?bl:_l)(n,e,t))}function Jn(e,t,n){var r=e._id;return e.each(function(){var o=Se(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return we(o,r).value[t]}}function Po(e,t){var n;return(typeof t=="number"?Re:t instanceof Dt?kr:(n=Dt(t))?(t=n,kr):ol)(e,t)}function Sl(e){return function(){this.removeAttribute(e)}}function Nl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Al(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Cl(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function kl(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function $l(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function Ml(e,t){var n=hn(e),r=n==="transform"?cl:Po;return this.attrTween(e,typeof t=="function"?(n.local?$l:kl)(n,r,Jn(this,"attr."+e,t)):t==null?(n.local?Nl:Sl)(n):(n.local?Cl:Al)(n,r,t))}function Tl(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Rl(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function zl(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Rl(e,i)),n}return o._value=t,o}function Dl(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Tl(e,i)),n}return o._value=t,o}function Il(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=hn(e);return this.tween(n,(r.local?zl:Dl)(r,t))}function Pl(e,t){return function(){Qn(this,e).delay=+t.apply(this,arguments)}}function Hl(e,t){return t=+t,function(){Qn(this,e).delay=t}}function Fl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Pl:Hl)(t,e)):we(this.node(),t).delay}function Ll(e,t){return function(){Se(this,e).duration=+t.apply(this,arguments)}}function jl(e,t){return t=+t,function(){Se(this,e).duration=t}}function Vl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ll:jl)(t,e)):we(this.node(),t).duration}function Bl(e,t){if(typeof t!="function")throw new Error;return function(){Se(this,e).ease=t}}function Ol(e){var t=this._id;return arguments.length?this.each(Bl(t,e)):we(this.node(),t).ease}function ql(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Se(this,e).ease=n}}function Xl(e){if(typeof e!="function")throw new Error;return this.each(ql(this._id,e))}function Yl(e){typeof e!="function"&&(e=mo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new $e(r,this._parents,this._name,this._id)}function Ul(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var c=t[a],u=n[a],l=c.length,f=s[a]=new Array(l),h,m=0;m<l;++m)(h=c[m]||u[m])&&(f[m]=h);for(;a<r;++a)s[a]=t[a];return new $e(s,this._parents,this._name,this._id)}function Wl(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Zl(e,t,n){var r,o,i=Wl(t)?Qn:Se;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function Gl(e,t){var n=this._id;return arguments.length<2?we(this.node(),n).on.on(e):this.each(Zl(n,e,t))}function Kl(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Ql(){return this.on("end.remove",Kl(this._id))}function Jl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Wn(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],c=a.length,u=i[s]=new Array(c),l,f,h=0;h<c;++h)(l=a[h])&&(f=e.call(l,l.__data__,h,a))&&("__data__"in l&&(f.__data__=l.__data__),u[h]=f,gn(u[h],t,n,h,u,we(l,n)));return new $e(i,this._parents,t,n)}function eu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ho(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var c=r[a],u=c.length,l,f=0;f<u;++f)if(l=c[f]){for(var h=e.call(l,l.__data__,f,c),m,w=we(l,n),y=0,E=h.length;y<E;++y)(m=h[y])&&gn(m,t,n,y,h,w);i.push(h),s.push(l)}return new $e(i,s,t,n)}var tu=Ft.prototype.constructor;function nu(){return new tu(this._groups,this._parents)}function ru(e,t){var n,r,o;return function(){var i=mt(this,e),s=(this.style.removeProperty(e),mt(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function Ho(e){return function(){this.style.removeProperty(e)}}function ou(e,t,n){var r,o=n+"",i;return function(){var s=mt(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function su(e,t,n){var r,o,i;return function(){var s=mt(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),mt(this,e))),s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a))}}function iu(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var c=Se(this,e),u=c.on,l=c.value[i]==null?a||(a=Ho(t)):void 0;(u!==n||o!==l)&&(r=(n=u).copy()).on(s,o=l),c.on=r}}function au(e,t,n){var r=(e+="")=="transform"?al:Po;return t==null?this.styleTween(e,ru(e,r)).on("end.style."+e,Ho(e)):typeof t=="function"?this.styleTween(e,su(e,r,Jn(this,"style."+e,t))).each(iu(this._id,e)):this.styleTween(e,ou(e,r,t),n).on("end.style."+e,null)}function cu(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function lu(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&cu(e,s,n)),r}return i._value=t,i}function uu(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,lu(e,t,n??""))}function fu(e){return function(){this.textContent=e}}function du(e){return function(){var t=e(this);this.textContent=t??""}}function hu(e){return this.tween("text",typeof e=="function"?du(Jn(this,"text",e)):fu(e==null?"":e+""))}function mu(e){return function(t){this.textContent=e.call(this,t)}}function gu(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&mu(o)),t}return r._value=e,r}function pu(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,gu(e))}function yu(){for(var e=this._name,t=this._id,n=Fo(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=we(c,t);gn(c,e,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new $e(r,this._parents,e,n)}function xu(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--o===0&&i()}};n.each(function(){var u=Se(this,r),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),o===0&&i()})}var wu=0;function $e(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Fo(){return++wu}var Ce=Ft.prototype;$e.prototype={constructor:$e,select:Jl,selectAll:eu,selectChild:Ce.selectChild,selectChildren:Ce.selectChildren,filter:Yl,merge:Ul,selection:nu,transition:yu,call:Ce.call,nodes:Ce.nodes,node:Ce.node,size:Ce.size,empty:Ce.empty,each:Ce.each,on:Gl,attr:Ml,attrTween:Il,style:au,styleTween:uu,text:hu,textTween:pu,remove:Ql,tween:El,delay:Fl,duration:Vl,ease:Ol,easeVarying:Xl,end:xu,[Symbol.iterator]:Ce[Symbol.iterator]};function vu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var bu={time:null,delay:0,duration:250,ease:vu};function _u(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Eu(e){var t,n;e instanceof $e?(t=e._id,e=e._name):(t=Fo(),(n=bu).time=Kn(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&gn(c,e,t,u,s,n||_u(c,t));return new $e(r,this._parents,e,t)}Ft.prototype.interrupt=vl;Ft.prototype.transition=Eu;const Ut=e=>()=>e;function Su(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function ke(e,t,n){this.k=e,this.x=t,this.y=n}ke.prototype={constructor:ke,scale:function(e){return e===1?this:new ke(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ke(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ie=new ke(1,0,0);ke.prototype;function An(e){e.stopImmediatePropagation()}function St(e){e.preventDefault(),e.stopImmediatePropagation()}function Nu(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Au(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ir(){return this.__zoom||Ie}function Cu(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ku(){return navigator.maxTouchPoints||"ontouchstart"in this}function $u(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Mu(){var e=Nu,t=Au,n=$u,r=Cu,o=ku,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=dl,u=dn("start","zoom","end"),l,f,h,m=500,w=150,y=0,E=10;function p(d){d.property("__zoom",Ir).on("wheel.zoom",j,{passive:!1}).on("mousedown.zoom",z).on("dblclick.zoom",V).filter(o).on("touchstart.zoom",k).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",I).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(d,N,b,$){var D=d.selection?d.selection():d;D.property("__zoom",Ir),d!==D?T(d,N,b,$):D.interrupt().each(function(){H(this,arguments).event($).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},p.scaleBy=function(d,N,b,$){p.scaleTo(d,function(){var D=this.__zoom.k,_=typeof N=="function"?N.apply(this,arguments):N;return D*_},b,$)},p.scaleTo=function(d,N,b,$){p.transform(d,function(){var D=t.apply(this,arguments),_=this.__zoom,M=b==null?x(D):typeof b=="function"?b.apply(this,arguments):b,P=_.invert(M),R=typeof N=="function"?N.apply(this,arguments):N;return n(v(S(_,R),M,P),D,s)},b,$)},p.translateBy=function(d,N,b,$){p.transform(d,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof b=="function"?b.apply(this,arguments):b),t.apply(this,arguments),s)},null,$)},p.translateTo=function(d,N,b,$,D){p.transform(d,function(){var _=t.apply(this,arguments),M=this.__zoom,P=$==null?x(_):typeof $=="function"?$.apply(this,arguments):$;return n(Ie.translate(P[0],P[1]).scale(M.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof b=="function"?-b.apply(this,arguments):-b),_,s)},$,D)};function S(d,N){return N=Math.max(i[0],Math.min(i[1],N)),N===d.k?d:new ke(N,d.x,d.y)}function v(d,N,b){var $=N[0]-b[0]*d.k,D=N[1]-b[1]*d.k;return $===d.x&&D===d.y?d:new ke(d.k,$,D)}function x(d){return[(+d[0][0]+ +d[1][0])/2,(+d[0][1]+ +d[1][1])/2]}function T(d,N,b,$){d.on("start.zoom",function(){H(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){H(this,arguments).event($).end()}).tween("zoom",function(){var D=this,_=arguments,M=H(D,_).event($),P=t.apply(D,_),R=b==null?x(P):typeof b=="function"?b.apply(D,_):b,B=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),O=D.__zoom,Y=typeof N=="function"?N.apply(D,_):N,W=c(O.invert(R).concat(B/O.k),Y.invert(R).concat(B/Y.k));return function(Z){if(Z===1)Z=Y;else{var G=W(Z),ee=B/G[2];Z=new ke(ee,R[0]-G[0]*ee,R[1]-G[1]*ee)}M.zoom(null,Z)}})}function H(d,N,b){return!b&&d.__zooming||new L(d,N)}function L(d,N){this.that=d,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(d,N),this.taps=0}L.prototype={event:function(d){return d&&(this.sourceEvent=d),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(d,N){return this.mouse&&d!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&d!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&d!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(d){var N=pe(this.that).datum();u.call(d,this.that,new Su(d,{sourceEvent:this.sourceEvent,target:p,type:d,transform:this.that.__zoom,dispatch:u}),N)}};function j(d,...N){if(!e.apply(this,arguments))return;var b=H(this,N).event(d),$=this.__zoom,D=Math.max(i[0],Math.min(i[1],$.k*Math.pow(2,r.apply(this,arguments)))),_=_e(d);if(b.wheel)(b.mouse[0][0]!==_[0]||b.mouse[0][1]!==_[1])&&(b.mouse[1]=$.invert(b.mouse[0]=_)),clearTimeout(b.wheel);else{if($.k===D)return;b.mouse=[_,$.invert(_)],tn(this),b.start()}St(d),b.wheel=setTimeout(M,w),b.zoom("mouse",n(v(S($,D),b.mouse[0],b.mouse[1]),b.extent,s));function M(){b.wheel=null,b.end()}}function z(d,...N){if(h||!e.apply(this,arguments))return;var b=d.currentTarget,$=H(this,N,!0).event(d),D=pe(d.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",B,!0),_=_e(d,b),M=d.clientX,P=d.clientY;So(d.view),An(d),$.mouse=[_,this.__zoom.invert(_)],tn(this),$.start();function R(O){if(St(O),!$.moved){var Y=O.clientX-M,W=O.clientY-P;$.moved=Y*Y+W*W>y}$.event(O).zoom("mouse",n(v($.that.__zoom,$.mouse[0]=_e(O,b),$.mouse[1]),$.extent,s))}function B(O){D.on("mousemove.zoom mouseup.zoom",null),No(O.view,$.moved),St(O),$.event(O).end()}}function V(d,...N){if(e.apply(this,arguments)){var b=this.__zoom,$=_e(d.changedTouches?d.changedTouches[0]:d,this),D=b.invert($),_=b.k*(d.shiftKey?.5:2),M=n(v(S(b,_),$,D),t.apply(this,N),s);St(d),a>0?pe(this).transition().duration(a).call(T,M,$,d):pe(this).call(p.transform,M,$,d)}}function k(d,...N){if(e.apply(this,arguments)){var b=d.touches,$=b.length,D=H(this,N,d.changedTouches.length===$).event(d),_,M,P,R;for(An(d),M=0;M<$;++M)P=b[M],R=_e(P,this),R=[R,this.__zoom.invert(R),P.identifier],D.touch0?!D.touch1&&D.touch0[2]!==R[2]&&(D.touch1=R,D.taps=0):(D.touch0=R,_=!0,D.taps=1+!!l);l&&(l=clearTimeout(l)),_&&(D.taps<2&&(f=R[0],l=setTimeout(function(){l=null},m)),tn(this),D.start())}}function F(d,...N){if(this.__zooming){var b=H(this,N).event(d),$=d.changedTouches,D=$.length,_,M,P,R;for(St(d),_=0;_<D;++_)M=$[_],P=_e(M,this),b.touch0&&b.touch0[2]===M.identifier?b.touch0[0]=P:b.touch1&&b.touch1[2]===M.identifier&&(b.touch1[0]=P);if(M=b.that.__zoom,b.touch1){var B=b.touch0[0],O=b.touch0[1],Y=b.touch1[0],W=b.touch1[1],Z=(Z=Y[0]-B[0])*Z+(Z=Y[1]-B[1])*Z,G=(G=W[0]-O[0])*G+(G=W[1]-O[1])*G;M=S(M,Math.sqrt(Z/G)),P=[(B[0]+Y[0])/2,(B[1]+Y[1])/2],R=[(O[0]+W[0])/2,(O[1]+W[1])/2]}else if(b.touch0)P=b.touch0[0],R=b.touch0[1];else return;b.zoom("touch",n(v(M,P,R),b.extent,s))}}function I(d,...N){if(this.__zooming){var b=H(this,N).event(d),$=d.changedTouches,D=$.length,_,M;for(An(d),h&&clearTimeout(h),h=setTimeout(function(){h=null},m),_=0;_<D;++_)M=$[_],b.touch0&&b.touch0[2]===M.identifier?delete b.touch0:b.touch1&&b.touch1[2]===M.identifier&&delete b.touch1;if(b.touch1&&!b.touch0&&(b.touch0=b.touch1,delete b.touch1),b.touch0)b.touch0[1]=this.__zoom.invert(b.touch0[0]);else if(b.end(),b.taps===2&&(M=_e(M,this),Math.hypot(f[0]-M[0],f[1]-M[1])<E)){var P=pe(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return p.wheelDelta=function(d){return arguments.length?(r=typeof d=="function"?d:Ut(+d),p):r},p.filter=function(d){return arguments.length?(e=typeof d=="function"?d:Ut(!!d),p):e},p.touchable=function(d){return arguments.length?(o=typeof d=="function"?d:Ut(!!d),p):o},p.extent=function(d){return arguments.length?(t=typeof d=="function"?d:Ut([[+d[0][0],+d[0][1]],[+d[1][0],+d[1][1]]]),p):t},p.scaleExtent=function(d){return arguments.length?(i[0]=+d[0],i[1]=+d[1],p):[i[0],i[1]]},p.translateExtent=function(d){return arguments.length?(s[0][0]=+d[0][0],s[1][0]=+d[1][0],s[0][1]=+d[0][1],s[1][1]=+d[1][1],p):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},p.constrain=function(d){return arguments.length?(n=d,p):n},p.duration=function(d){return arguments.length?(a=+d,p):a},p.interpolate=function(d){return arguments.length?(c=d,p):c},p.on=function(){var d=u.on.apply(u,arguments);return d===u?p:d},p.clickDistance=function(d){return arguments.length?(y=(d=+d)*d,p):Math.sqrt(y)},p.tapDistance=function(d){return arguments.length?(E=+d,p):E},p}const pn=g.createContext(null),Tu=pn.Provider,Me={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Lo=Me.error001();function J(e,t){const n=g.useContext(pn);if(n===null)throw new Error(Lo);return uo(n,e,t)}const re=()=>{const e=g.useContext(pn);if(e===null)throw new Error(Lo);return g.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Ru=e=>e.userSelectionActive?"none":"all";function jo({position:e,children:t,className:n,style:r,...o}){const i=J(Ru),s=`${e}`.split("-");return C.createElement("div",{className:ie(["react-flow__panel",n,...s]),style:{...r,pointerEvents:i},...o},t)}function zu({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:C.createElement(jo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},C.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Du=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...l})=>{const f=g.useRef(null),[h,m]=g.useState({x:0,y:0,width:0,height:0}),w=ie(["react-flow__edge-textwrapper",u]);return g.useEffect(()=>{if(f.current){const y=f.current.getBBox();m({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),typeof n>"u"||!n?null:C.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:w,visibility:h.width?"visible":"hidden",...l},o&&C.createElement("rect",{width:h.width+2*s[0],x:-s[0],y:-s[1],height:h.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),C.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:f,style:r},n),c)};var Iu=g.memo(Du);const er=e=>({width:e.offsetWidth,height:e.offsetHeight}),pt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),tr=(e={x:0,y:0},t)=>({x:pt(e.x,t[0][0],t[1][0]),y:pt(e.y,t[0][1],t[1][1])}),Pr=(e,t,n)=>e<t?pt(Math.abs(e-t),1,50)/50:e>n?-pt(Math.abs(e-n),1,50)/50:0,Vo=(e,t)=>{const n=Pr(e.x,35,t.width-35)*20,r=Pr(e.y,35,t.height-35)*20;return[n,r]},Bo=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Pu=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),nr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Hu=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Hr=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),jn=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Fu=e=>de(e.width)&&de(e.height)&&de(e.x)&&de(e.y),de=e=>!isNaN(e)&&isFinite(e),te=Symbol.for("internals"),Oo=["Enter"," ","Escape"],Lu=(e,t)=>{},ju=e=>"nativeEvent"in e;function Vn(e){var o,i;const t=ju(e)?e.nativeEvent:e,n=((i=(o=t.composedPath)==null?void 0:o.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const qo=e=>"clientX"in e,Pe=(e,t)=>{var i,s;const n=qo(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},ln=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},jt=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:h,interactionWidth:m=20})=>C.createElement(C.Fragment,null,C.createElement("path",{id:e,style:l,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:h}),m&&C.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),o&&de(n)&&de(r)?C.createElement(Iu,{x:n,y:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);jt.displayName="BaseEdge";function Nt(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(i=>i.id===e);o&&n(r,{...o})}}function Xo({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function Yo({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+o*.375+s*.375+n*.125,u=t*.125+i*.375+a*.375+r*.125,l=Math.abs(c-e),f=Math.abs(u-t);return[c,u,l,f]}var He;(function(e){e.Strict="strict",e.Loose="loose"})(He||(He={}));var Ue;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ue||(Ue={}));var Pt;(function(e){e.Partial="partial",e.Full="full"})(Pt||(Pt={}));var De;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(De||(De={}));var yt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(yt||(yt={}));var q;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(q||(q={}));function Fr({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===q.Left||e===q.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Uo({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:r,targetY:o,targetPosition:i=q.Top}){const[s,a]=Fr({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,u]=Fr({pos:i,x1:r,y1:o,x2:e,y2:t}),[l,f,h,m]=Yo({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${s},${a} ${c},${u} ${r},${o}`,l,f,h,m]}const rr=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=q.Bottom,targetPosition:i=q.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:w,interactionWidth:y})=>{const[E,p,S]=Uo({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i});return C.createElement(jt,{path:E,labelX:p,labelY:S,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:w,interactionWidth:y})});rr.displayName="SimpleBezierEdge";const Lr={[q.Left]:{x:-1,y:0},[q.Right]:{x:1,y:0},[q.Top]:{x:0,y:-1},[q.Bottom]:{x:0,y:1}},Vu=({source:e,sourcePosition:t=q.Bottom,target:n})=>t===q.Left||t===q.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},jr=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Bu({source:e,sourcePosition:t=q.Bottom,target:n,targetPosition:r=q.Top,center:o,offset:i}){const s=Lr[t],a=Lr[r],c={x:e.x+s.x*i,y:e.y+s.y*i},u={x:n.x+a.x*i,y:n.y+a.y*i},l=Vu({source:c,sourcePosition:t,target:u}),f=l.x!==0?"x":"y",h=l[f];let m=[],w,y;const E={x:0,y:0},p={x:0,y:0},[S,v,x,T]=Xo({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[f]*a[f]===-1){w=o.x??S,y=o.y??v;const L=[{x:w,y:c.y},{x:w,y:u.y}],j=[{x:c.x,y},{x:u.x,y}];s[f]===h?m=f==="x"?L:j:m=f==="x"?j:L}else{const L=[{x:c.x,y:u.y}],j=[{x:u.x,y:c.y}];if(f==="x"?m=s.x===h?j:L:m=s.y===h?L:j,t===r){const I=Math.abs(e[f]-n[f]);if(I<=i){const d=Math.min(i-1,i-I);s[f]===h?E[f]=(c[f]>e[f]?-1:1)*d:p[f]=(u[f]>n[f]?-1:1)*d}}if(t!==r){const I=f==="x"?"y":"x",d=s[f]===a[I],N=c[I]>u[I],b=c[I]<u[I];(s[f]===1&&(!d&&N||d&&b)||s[f]!==1&&(!d&&b||d&&N))&&(m=f==="x"?L:j)}const z={x:c.x+E.x,y:c.y+E.y},V={x:u.x+p.x,y:u.y+p.y},k=Math.max(Math.abs(z.x-m[0].x),Math.abs(V.x-m[0].x)),F=Math.max(Math.abs(z.y-m[0].y),Math.abs(V.y-m[0].y));k>=F?(w=(z.x+V.x)/2,y=m[0].y):(w=m[0].x,y=(z.y+V.y)/2)}return[[e,{x:c.x+E.x,y:c.y+E.y},...m,{x:u.x+p.x,y:u.y+p.y},n],w,y,x,T]}function Ou(e,t,n,r){const o=Math.min(jr(e,t)/2,jr(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<n.x?-1:1,l=e.y<n.y?1:-1;return`L ${i+o*u},${s}Q ${i},${s} ${i},${s+o*l}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+o*c}Q ${i},${s} ${i+o*a},${s}`}function Bn({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:r,targetY:o,targetPosition:i=q.Top,borderRadius:s=5,centerX:a,centerY:c,offset:u=20}){const[l,f,h,m,w]=Bu({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:c},offset:u});return[l.reduce((E,p,S)=>{let v="";return S>0&&S<l.length-1?v=Ou(l[S-1],p,l[S+1],s):v=`${S===0?"M":"L"}${p.x} ${p.y}`,E+=v,E},""),f,h,m,w]}const yn=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,sourcePosition:f=q.Bottom,targetPosition:h=q.Top,markerEnd:m,markerStart:w,pathOptions:y,interactionWidth:E})=>{const[p,S,v]=Bn({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:h,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset});return C.createElement(jt,{path:p,labelX:S,labelY:v,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:m,markerStart:w,interactionWidth:E})});yn.displayName="SmoothStepEdge";const or=g.memo(e=>{var t;return C.createElement(yn,{...e,pathOptions:g.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});or.displayName="StepEdge";function qu({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=Xo({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const sr=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:h,interactionWidth:m})=>{const[w,y,E]=qu({sourceX:e,sourceY:t,targetX:n,targetY:r});return C.createElement(jt,{path:w,labelX:y,labelY:E,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:h,interactionWidth:m})});sr.displayName="StraightEdge";function Wt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Vr({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case q.Left:return[t-Wt(t-r,i),n];case q.Right:return[t+Wt(r-t,i),n];case q.Top:return[t,n-Wt(n-o,i)];case q.Bottom:return[t,n+Wt(o-n,i)]}}function Wo({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:r,targetY:o,targetPosition:i=q.Top,curvature:s=.25}){const[a,c]=Vr({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[u,l]=Vr({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[f,h,m,w]=Yo({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${e},${t} C${a},${c} ${u},${l} ${r},${o}`,f,h,m,w]}const un=g.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=q.Bottom,targetPosition:i=q.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:w,pathOptions:y,interactionWidth:E})=>{const[p,S,v]=Wo({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i,curvature:y==null?void 0:y.curvature});return C.createElement(jt,{path:p,labelX:S,labelY:v,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:w,interactionWidth:E})});un.displayName="BezierEdge";const ir=g.createContext(null),Xu=ir.Provider;ir.Consumer;const Yu=()=>g.useContext(ir),Uu=e=>"id"in e&&"source"in e&&"target"in e,Wu=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,On=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,Zu=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Gu=(e,t)=>{if(!e.source||!e.target)return t;let n;return Uu(e)?n={...e}:n={...e,id:Wu(e)},Zu(n,t)?t:t.concat(n)},qn=({x:e,y:t},[n,r,o],i,[s,a])=>{const c={x:(e-n)/o,y:(t-r)/o};return i?{x:s*Math.round(c.x/s),y:a*Math.round(c.y/a)}:c},Zo=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),ft=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},ar=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const{x:i,y:s}=ft(o,t).positionAbsolute;return Pu(r,nr({x:i,y:s,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Hu(n)},Go=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1,a=[0,0])=>{const c={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},u=[];return e.forEach(l=>{const{width:f,height:h,selectable:m=!0,hidden:w=!1}=l;if(s&&!m||w)return!1;const{positionAbsolute:y}=ft(l,a),E={x:y.x,y:y.y,width:f||0,height:h||0},p=jn(c,E),S=typeof f>"u"||typeof h>"u"||f===null||h===null,v=i&&p>0,x=(f||0)*(h||0);(S||v||p>=x||l.dragging)&&u.push(l)}),u},Ko=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Qo=(e,t,n,r,o,i=.1)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(s,a),u=pt(c,r,o),l=e.x+e.width/2,f=e.y+e.height/2,h=t/2-l*u,m=n/2-f*u;return{x:h,y:m,zoom:u}},Xe=(e,t=0)=>e.transition().duration(t);function Br(e,t,n,r){return(t[n]||[]).reduce((o,i)=>{var s,a;return`${e.id}-${i.id}-${n}`!==r&&o.push({id:i.id||null,type:n,nodeId:e.id,x:(((s=e.positionAbsolute)==null?void 0:s.x)??0)+i.x+i.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+i.y+i.height/2}),o},[])}function Ku(e,t,n,r,o,i){const{x:s,y:a}=Pe(e),u=t.elementsFromPoint(s,a).find(w=>w.classList.contains("react-flow__handle"));if(u){const w=u.getAttribute("data-nodeid");if(w){const y=cr(void 0,u),E=u.getAttribute("data-handleid"),p=i({nodeId:w,id:E,type:y});if(p){const S=o.find(v=>v.nodeId===w&&v.type===y&&v.id===E);return{handle:{id:E,type:y,nodeId:w,x:(S==null?void 0:S.x)||n.x,y:(S==null?void 0:S.y)||n.y},validHandleResult:p}}}}let l=[],f=1/0;if(o.forEach(w=>{const y=Math.sqrt((w.x-n.x)**2+(w.y-n.y)**2);if(y<=r){const E=i(w);y<=f&&(y<f?l=[{handle:w,validHandleResult:E}]:y===f&&l.push({handle:w,validHandleResult:E}),f=y)}}),!l.length)return{handle:null,validHandleResult:Jo()};if(l.length===1)return l[0];const h=l.some(({validHandleResult:w})=>w.isValid),m=l.some(({handle:w})=>w.type==="target");return l.find(({handle:w,validHandleResult:y})=>m?w.type==="target":h?y.isValid:!0)||l[0]}const Qu={source:null,target:null,sourceHandle:null,targetHandle:null},Jo=()=>({handleDomNode:null,isValid:!1,connection:Qu,endHandle:null});function es(e,t,n,r,o,i,s){const a=o==="target",c=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...Jo(),handleDomNode:c};if(c){const l=cr(void 0,c),f=c.getAttribute("data-nodeid"),h=c.getAttribute("data-handleid"),m=c.classList.contains("connectable"),w=c.classList.contains("connectableend"),y={source:a?f:n,sourceHandle:a?h:r,target:a?n:f,targetHandle:a?r:h};u.connection=y,m&&w&&(t===He.Strict?a&&l==="source"||!a&&l==="target":f!==n||h!==r)&&(u.endHandle={nodeId:f,handleId:h,type:l},u.isValid=i(y))}return u}function Ju({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((o,i)=>{if(i[te]){const{handleBounds:s}=i[te];let a=[],c=[];s&&(a=Br(i,s,"source",`${t}-${n}-${r}`),c=Br(i,s,"target",`${t}-${n}-${r}`)),o.push(...a,...c)}return o},[])}function cr(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Cn(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ef(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function ts({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:i,setState:s,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const l=Bo(e.target),{connectionMode:f,domNode:h,autoPanOnConnect:m,connectionRadius:w,onConnectStart:y,panBy:E,getNodes:p,cancelConnection:S}=i();let v=0,x;const{x:T,y:H}=Pe(e),L=l==null?void 0:l.elementFromPoint(T,H),j=cr(c,L),z=h==null?void 0:h.getBoundingClientRect();if(!z||!j)return;let V,k=Pe(e,z),F=!1,I=null,d=!1,N=null;const b=Ju({nodes:p(),nodeId:n,handleId:t,handleType:j}),$=()=>{if(!m)return;const[M,P]=Vo(k,z);E({x:M,y:P}),v=requestAnimationFrame($)};s({connectionPosition:k,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:j,connectionStartHandle:{nodeId:n,handleId:t,type:j},connectionEndHandle:null}),y==null||y(e,{nodeId:n,handleId:t,handleType:j});function D(M){const{transform:P}=i();k=Pe(M,z);const{handle:R,validHandleResult:B}=Ku(M,l,qn(k,P,!1,[1,1]),w,b,O=>es(O,f,n,t,o?"target":"source",a,l));if(x=R,F||($(),F=!0),N=B.handleDomNode,I=B.connection,d=B.isValid,s({connectionPosition:x&&d?Zo({x:x.x,y:x.y},P):k,connectionStatus:ef(!!x,d),connectionEndHandle:B.endHandle}),!x&&!d&&!N)return Cn(V);I.source!==I.target&&N&&(Cn(V),V=N,N.classList.add("connecting","react-flow__handle-connecting"),N.classList.toggle("valid",d),N.classList.toggle("react-flow__handle-valid",d))}function _(M){var P,R;(x||N)&&I&&d&&(r==null||r(I)),(R=(P=i()).onConnectEnd)==null||R.call(P,M),c&&(u==null||u(M)),Cn(V),S(),cancelAnimationFrame(v),F=!1,d=!1,I=null,N=null,l.removeEventListener("mousemove",D),l.removeEventListener("mouseup",_),l.removeEventListener("touchmove",D),l.removeEventListener("touchend",_)}l.addEventListener("mousemove",D),l.addEventListener("mouseup",_),l.addEventListener("touchmove",D),l.addEventListener("touchend",_)}const Or=()=>!0,tf=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),nf=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:s}=r;return{connecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n}},ns=g.forwardRef(({type:e="source",position:t=q.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:u,onMouseDown:l,onTouchStart:f,...h},m)=>{var z,V;const w=s||null,y=e==="target",E=re(),p=Yu(),{connectOnClick:S,noPanClassName:v}=J(tf,se),{connecting:x,clickConnecting:T}=J(nf(p,w,e),se);p||(V=(z=E.getState()).onError)==null||V.call(z,"010",Me.error010());const H=k=>{const{defaultEdgeOptions:F,onConnect:I,hasDefaultEdges:d}=E.getState(),N={...F,...k};if(d){const{edges:b,setEdges:$}=E.getState();$(Gu(N,b))}I==null||I(N),a==null||a(N)},L=k=>{if(!p)return;const F=qo(k);o&&(F&&k.button===0||!F)&&ts({event:k,handleId:w,nodeId:p,onConnect:H,isTarget:y,getState:E.getState,setState:E.setState,isValidConnection:n||E.getState().isValidConnection||Or}),F?l==null||l(k):f==null||f(k)},j=k=>{const{onClickConnectStart:F,onClickConnectEnd:I,connectionClickStartHandle:d,connectionMode:N,isValidConnection:b}=E.getState();if(!p||!d&&!o)return;if(!d){F==null||F(k,{nodeId:p,handleId:w,handleType:e}),E.setState({connectionClickStartHandle:{nodeId:p,type:e,handleId:w}});return}const $=Bo(k.target),D=n||b||Or,{connection:_,isValid:M}=es({nodeId:p,id:w,type:e},N,d.nodeId,d.handleId||null,d.type,D,$);M&&H(_),I==null||I(k),E.setState({connectionClickStartHandle:null})};return C.createElement("div",{"data-handleid":w,"data-nodeid":p,"data-handlepos":t,"data-id":`${p}-${w}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",v,u,{source:!y,target:y,connectable:r,connectablestart:o,connectableend:i,connecting:T,connectionindicator:r&&(o&&!x||i&&x)}]),onMouseDown:L,onTouchStart:L,onClick:S?j:void 0,ref:m,...h},c)});ns.displayName="Handle";var xt=g.memo(ns);const rs=({data:e,isConnectable:t,targetPosition:n=q.Top,sourcePosition:r=q.Bottom})=>C.createElement(C.Fragment,null,C.createElement(xt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,C.createElement(xt,{type:"source",position:r,isConnectable:t}));rs.displayName="DefaultNode";var Xn=g.memo(rs);const os=({data:e,isConnectable:t,sourcePosition:n=q.Bottom})=>C.createElement(C.Fragment,null,e==null?void 0:e.label,C.createElement(xt,{type:"source",position:n,isConnectable:t}));os.displayName="InputNode";var ss=g.memo(os);const is=({data:e,isConnectable:t,targetPosition:n=q.Top})=>C.createElement(C.Fragment,null,C.createElement(xt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);is.displayName="OutputNode";var as=g.memo(is);const lr=()=>null;lr.displayName="GroupNode";const rf=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Zt=e=>e.id;function of(e,t){return se(e.selectedNodes.map(Zt),t.selectedNodes.map(Zt))&&se(e.selectedEdges.map(Zt),t.selectedEdges.map(Zt))}const cs=g.memo(({onSelectionChange:e})=>{const t=re(),{selectedNodes:n,selectedEdges:r}=J(rf,of);return g.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChange.forEach(i=>i(o))},[n,r,e]),null});cs.displayName="SelectionListener";const sf=e=>!!e.onSelectionChange;function af({onSelectionChange:e}){const t=J(sf);return e||t?C.createElement(cs,{onSelectionChange:e}):null}const cf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function nt(e,t){g.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function U(e,t,n){g.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const lf=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:i,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:l,nodesFocusable:f,edgesFocusable:h,edgesUpdatable:m,elevateNodesOnSelect:w,minZoom:y,maxZoom:E,nodeExtent:p,onNodesChange:S,onEdgesChange:v,elementsSelectable:x,connectionMode:T,snapGrid:H,snapToGrid:L,translateExtent:j,connectOnClick:z,defaultEdgeOptions:V,fitView:k,fitViewOptions:F,onNodesDelete:I,onEdgesDelete:d,onNodeDrag:N,onNodeDragStart:b,onNodeDragStop:$,onSelectionDrag:D,onSelectionDragStart:_,onSelectionDragStop:M,noPanClassName:P,nodeOrigin:R,rfId:B,autoPanOnConnect:O,autoPanOnNodeDrag:Y,onError:W,connectionRadius:Z,isValidConnection:G,nodeDragThreshold:ee})=>{const{setNodes:K,setEdges:he,setDefaultNodesAndEdges:ue,setMinZoom:me,setMaxZoom:fe,setTranslateExtent:ne,setNodeExtent:ve,reset:Q}=J(cf,se),X=re();return g.useEffect(()=>{const ce=r==null?void 0:r.map(Fe=>({...Fe,...V}));return ue(n,ce),()=>{Q()}},[]),U("defaultEdgeOptions",V,X.setState),U("connectionMode",T,X.setState),U("onConnect",o,X.setState),U("onConnectStart",i,X.setState),U("onConnectEnd",s,X.setState),U("onClickConnectStart",a,X.setState),U("onClickConnectEnd",c,X.setState),U("nodesDraggable",u,X.setState),U("nodesConnectable",l,X.setState),U("nodesFocusable",f,X.setState),U("edgesFocusable",h,X.setState),U("edgesUpdatable",m,X.setState),U("elementsSelectable",x,X.setState),U("elevateNodesOnSelect",w,X.setState),U("snapToGrid",L,X.setState),U("snapGrid",H,X.setState),U("onNodesChange",S,X.setState),U("onEdgesChange",v,X.setState),U("connectOnClick",z,X.setState),U("fitViewOnInit",k,X.setState),U("fitViewOnInitOptions",F,X.setState),U("onNodesDelete",I,X.setState),U("onEdgesDelete",d,X.setState),U("onNodeDrag",N,X.setState),U("onNodeDragStart",b,X.setState),U("onNodeDragStop",$,X.setState),U("onSelectionDrag",D,X.setState),U("onSelectionDragStart",_,X.setState),U("onSelectionDragStop",M,X.setState),U("noPanClassName",P,X.setState),U("nodeOrigin",R,X.setState),U("rfId",B,X.setState),U("autoPanOnConnect",O,X.setState),U("autoPanOnNodeDrag",Y,X.setState),U("onError",W,X.setState),U("connectionRadius",Z,X.setState),U("isValidConnection",G,X.setState),U("nodeDragThreshold",ee,X.setState),nt(e,K),nt(t,he),nt(y,me),nt(E,fe),nt(j,ne),nt(p,ve),null},qr={display:"none"},uf={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ls="react-flow__node-desc",us="react-flow__edge-desc",ff="react-flow__aria-live",df=e=>e.ariaLiveMessage;function hf({rfId:e}){const t=J(df);return C.createElement("div",{id:`${ff}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:uf},t)}function mf({rfId:e,disableKeyboardA11y:t}){return C.createElement(C.Fragment,null,C.createElement("div",{id:`${ls}-${e}`,style:qr},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),C.createElement("div",{id:`${us}-${e}`,style:qr},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&C.createElement(hf,{rfId:e}))}var Ht=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=g.useState(!1),o=g.useRef(!1),i=g.useRef(new Set([])),[s,a]=g.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),l=u.reduce((f,h)=>f.concat(...h),[]);return[u,l]}return[[],[]]},[e]);return g.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const l=m=>{if(o.current=m.ctrlKey||m.metaKey||m.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&Vn(m))return!1;const y=Yr(m.code,a);i.current.add(m[y]),Xr(s,i.current,!1)&&(m.preventDefault(),r(!0))},f=m=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&Vn(m))return!1;const y=Yr(m.code,a);Xr(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(m[y]),m.key==="Meta"&&i.current.clear(),o.current=!1},h=()=>{i.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",l),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",h),()=>{u==null||u.removeEventListener("keydown",l),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",h)}}},[e,r]),n};function Xr(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Yr(e,t){return t.includes(e)?"code":"key"}function fs(e,t,n,r){var a,c;const o=e.parentNode||e.parentId;if(!o)return n;const i=t.get(o),s=ft(i,r);return fs(i,t,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(((a=i[te])==null?void 0:a.z)??0)>(n.z??0)?((c=i[te])==null?void 0:c.z)??0:n.z??0},r)}function ds(e,t,n){e.forEach(r=>{var i;const o=r.parentNode||r.parentId;if(o&&!e.has(o))throw new Error(`Parent node ${o} not found`);if(o||n!=null&&n[r.id]){const{x:s,y:a,z:c}=fs(r,e,{...r.position,z:((i=r[te])==null?void 0:i.z)??0},t);r.positionAbsolute={x:s,y:a},r[te].z=c,n!=null&&n[r.id]&&(r[te].isParent=!0)}})}function kn(e,t,n,r){const o=new Map,i={},s=r?1e3:0;return e.forEach(a=>{var m;const c=(de(a.zIndex)?a.zIndex:0)+(a.selected?s:0),u=t.get(a.id),l={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},f=a.parentNode||a.parentId;f&&(i[f]=!0);const h=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(l,te,{enumerable:!1,value:{handleBounds:h||(m=u==null?void 0:u[te])==null?void 0:m.handleBounds,z:c}}),o.set(a.id,l)}),ds(o,n,i),o}function hs(e,t={}){const{getNodes:n,width:r,height:o,minZoom:i,maxZoom:s,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:l,nodeOrigin:f}=e(),h=t.initial&&!u&&l;if(a&&c&&(h||!t.initial)){const w=n().filter(E=>{var S;const p=t.includeHiddenNodes?E.width&&E.height:!E.hidden;return(S=t.nodes)!=null&&S.length?p&&t.nodes.some(v=>v.id===E.id):p}),y=w.every(E=>E.width&&E.height);if(w.length>0&&y){const E=ar(w,f),{x:p,y:S,zoom:v}=Qo(E,r,o,t.minZoom??i,t.maxZoom??s,t.padding??.1),x=Ie.translate(p,S).scale(v);return typeof t.duration=="number"&&t.duration>0?a.transform(Xe(c,t.duration),x):a.transform(c,x),!0}}return!1}function gf(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[te]:r[te],selected:n.selected})}),new Map(t)}function pf(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function Gt({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:i,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();e!=null&&e.length&&(c&&r({nodeInternals:gf(e,o)}),s==null||s(e)),t!=null&&t.length&&(u&&r({edges:pf(t,i)}),a==null||a(t))}const rt=()=>{},yf={zoomIn:rt,zoomOut:rt,zoomTo:rt,getZoom:()=>1,setViewport:rt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:rt,fitBounds:rt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},xf=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),wf=()=>{const e=re(),{d3Zoom:t,d3Selection:n}=J(xf,se);return g.useMemo(()=>n&&t?{zoomIn:o=>t.scaleBy(Xe(n,o==null?void 0:o.duration),1.2),zoomOut:o=>t.scaleBy(Xe(n,o==null?void 0:o.duration),1/1.2),zoomTo:(o,i)=>t.scaleTo(Xe(n,i==null?void 0:i.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,i)=>{const[s,a,c]=e.getState().transform,u=Ie.translate(o.x??s,o.y??a).scale(o.zoom??c);t.transform(Xe(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[o,i,s]=e.getState().transform;return{x:o,y:i,zoom:s}},fitView:o=>hs(e.getState,o),setCenter:(o,i,s)=>{const{width:a,height:c,maxZoom:u}=e.getState(),l=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:u,f=a/2-o*l,h=c/2-i*l,m=Ie.translate(f,h).scale(l);t.transform(Xe(n,s==null?void 0:s.duration),m)},fitBounds:(o,i)=>{const{width:s,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:l,y:f,zoom:h}=Qo(o,s,a,c,u,(i==null?void 0:i.padding)??.1),m=Ie.translate(l,f).scale(h);t.transform(Xe(n,i==null?void 0:i.duration),m)},project:o=>{const{transform:i,snapToGrid:s,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),qn(o,i,s,a)},screenToFlowPosition:o=>{const{transform:i,snapToGrid:s,snapGrid:a,domNode:c}=e.getState();if(!c)return o;const{x:u,y:l}=c.getBoundingClientRect(),f={x:o.x-u,y:o.y-l};return qn(f,i,s,a)},flowToScreenPosition:o=>{const{transform:i,domNode:s}=e.getState();if(!s)return o;const{x:a,y:c}=s.getBoundingClientRect(),u=Zo(o,i);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:yf,[t,n])};function ur(){const e=wf(),t=re(),n=g.useCallback(()=>t.getState().getNodes().map(y=>({...y})),[]),r=g.useCallback(y=>t.getState().nodeInternals.get(y),[]),o=g.useCallback(()=>{const{edges:y=[]}=t.getState();return y.map(E=>({...E}))},[]),i=g.useCallback(y=>{const{edges:E=[]}=t.getState();return E.find(p=>p.id===y)},[]),s=g.useCallback(y=>{const{getNodes:E,setNodes:p,hasDefaultNodes:S,onNodesChange:v}=t.getState(),x=E(),T=typeof y=="function"?y(x):y;if(S)p(T);else if(v){const H=T.length===0?x.map(L=>({type:"remove",id:L.id})):T.map(L=>({item:L,type:"reset"}));v(H)}},[]),a=g.useCallback(y=>{const{edges:E=[],setEdges:p,hasDefaultEdges:S,onEdgesChange:v}=t.getState(),x=typeof y=="function"?y(E):y;if(S)p(x);else if(v){const T=x.length===0?E.map(H=>({type:"remove",id:H.id})):x.map(H=>({item:H,type:"reset"}));v(T)}},[]),c=g.useCallback(y=>{const E=Array.isArray(y)?y:[y],{getNodes:p,setNodes:S,hasDefaultNodes:v,onNodesChange:x}=t.getState();if(v){const H=[...p(),...E];S(H)}else if(x){const T=E.map(H=>({item:H,type:"add"}));x(T)}},[]),u=g.useCallback(y=>{const E=Array.isArray(y)?y:[y],{edges:p=[],setEdges:S,hasDefaultEdges:v,onEdgesChange:x}=t.getState();if(v)S([...p,...E]);else if(x){const T=E.map(H=>({item:H,type:"add"}));x(T)}},[]),l=g.useCallback(()=>{const{getNodes:y,edges:E=[],transform:p}=t.getState(),[S,v,x]=p;return{nodes:y().map(T=>({...T})),edges:E.map(T=>({...T})),viewport:{x:S,y:v,zoom:x}}},[]),f=g.useCallback(({nodes:y,edges:E})=>{const{nodeInternals:p,getNodes:S,edges:v,hasDefaultNodes:x,hasDefaultEdges:T,onNodesDelete:H,onEdgesDelete:L,onNodesChange:j,onEdgesChange:z}=t.getState(),V=(y||[]).map(N=>N.id),k=(E||[]).map(N=>N.id),F=S().reduce((N,b)=>{const $=b.parentNode||b.parentId,D=!V.includes(b.id)&&$&&N.find(M=>M.id===$);return(typeof b.deletable=="boolean"?b.deletable:!0)&&(V.includes(b.id)||D)&&N.push(b),N},[]),I=v.filter(N=>typeof N.deletable=="boolean"?N.deletable:!0),d=I.filter(N=>k.includes(N.id));if(F||d){const N=Ko(F,I),b=[...d,...N],$=b.reduce((D,_)=>(D.includes(_.id)||D.push(_.id),D),[]);if((T||x)&&(T&&t.setState({edges:v.filter(D=>!$.includes(D.id))}),x&&(F.forEach(D=>{p.delete(D.id)}),t.setState({nodeInternals:new Map(p)}))),$.length>0&&(L==null||L(b),z&&z($.map(D=>({id:D,type:"remove"})))),F.length>0&&(H==null||H(F),j)){const D=F.map(_=>({id:_.id,type:"remove"}));j(D)}}},[]),h=g.useCallback(y=>{const E=Fu(y),p=E?null:t.getState().nodeInternals.get(y.id);return!E&&!p?[null,null,E]:[E?y:Hr(p),p,E]},[]),m=g.useCallback((y,E=!0,p)=>{const[S,v,x]=h(y);return S?(p||t.getState().getNodes()).filter(T=>{if(!x&&(T.id===v.id||!T.positionAbsolute))return!1;const H=Hr(T),L=jn(H,S);return E&&L>0||L>=S.width*S.height}):[]},[]),w=g.useCallback((y,E,p=!0)=>{const[S]=h(y);if(!S)return!1;const v=jn(S,E);return p&&v>0||v>=S.width*S.height},[]);return g.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:i,setNodes:s,setEdges:a,addNodes:c,addEdges:u,toObject:l,deleteElements:f,getIntersectingNodes:m,isNodeIntersecting:w}),[e,n,r,o,i,s,a,c,u,l,f,m,w])}const vf={actInsideInputWithModifier:!1};var bf=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=re(),{deleteElements:r}=ur(),o=Ht(e,vf),i=Ht(t);g.useEffect(()=>{if(o){const{edges:s,getNodes:a}=n.getState(),c=a().filter(l=>l.selected),u=s.filter(l=>l.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),g.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function _f(e){const t=re();g.useEffect(()=>{let n;const r=()=>{var i,s;if(!e.current)return;const o=er(e.current);(o.height===0||o.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",Me.error004())),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const fr={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ef=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Kt=e=>({x:e.x,y:e.y,zoom:e.k}),ot=(e,t)=>e.target.closest(`.${t}`),Ur=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Wr=e=>{const t=e.ctrlKey&&ln()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Sf=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Nf=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:o=!0,zoomOnPinch:i=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=Ue.Free,zoomOnDoubleClick:u=!0,elementsSelectable:l,panOnDrag:f=!0,defaultViewport:h,translateExtent:m,minZoom:w,maxZoom:y,zoomActivationKeyCode:E,preventScrolling:p=!0,children:S,noWheelClassName:v,noPanClassName:x})=>{const T=g.useRef(),H=re(),L=g.useRef(!1),j=g.useRef(!1),z=g.useRef(null),V=g.useRef({x:0,y:0,zoom:0}),{d3Zoom:k,d3Selection:F,d3ZoomHandler:I,userSelectionActive:d}=J(Sf,se),N=Ht(E),b=g.useRef(0),$=g.useRef(!1),D=g.useRef();return _f(z),g.useEffect(()=>{if(z.current){const _=z.current.getBoundingClientRect(),M=Mu().scaleExtent([w,y]).translateExtent(m),P=pe(z.current).call(M),R=Ie.translate(h.x,h.y).scale(pt(h.zoom,w,y)),B=[[0,0],[_.width,_.height]],O=M.constrain()(R,B,m);M.transform(P,O),M.wheelDelta(Wr),H.setState({d3Zoom:M,d3Selection:P,d3ZoomHandler:P.on("wheel.zoom"),transform:[O.x,O.y,O.k],domNode:z.current.closest(".react-flow")})}},[]),g.useEffect(()=>{F&&k&&(s&&!N&&!d?F.on("wheel.zoom",_=>{if(ot(_,v))return!1;_.preventDefault(),_.stopImmediatePropagation();const M=F.property("__zoom").k||1;if(_.ctrlKey&&i){const G=_e(_),ee=Wr(_),K=M*Math.pow(2,ee);k.scaleTo(F,K,G,_);return}const P=_.deltaMode===1?20:1;let R=c===Ue.Vertical?0:_.deltaX*P,B=c===Ue.Horizontal?0:_.deltaY*P;!ln()&&_.shiftKey&&c!==Ue.Vertical&&(R=_.deltaY*P,B=0),k.translateBy(F,-(R/M)*a,-(B/M)*a,{internal:!0});const O=Kt(F.property("__zoom")),{onViewportChangeStart:Y,onViewportChange:W,onViewportChangeEnd:Z}=H.getState();clearTimeout(D.current),$.current||($.current=!0,t==null||t(_,O),Y==null||Y(O)),$.current&&(e==null||e(_,O),W==null||W(O),D.current=setTimeout(()=>{n==null||n(_,O),Z==null||Z(O),$.current=!1},150))},{passive:!1}):typeof I<"u"&&F.on("wheel.zoom",function(_,M){if(!p&&_.type==="wheel"&&!_.ctrlKey||ot(_,v))return null;_.preventDefault(),I.call(this,_,M)},{passive:!1}))},[d,s,c,F,k,I,N,i,p,v,t,e,n]),g.useEffect(()=>{k&&k.on("start",_=>{var R,B;if(!_.sourceEvent||_.sourceEvent.internal)return null;b.current=(R=_.sourceEvent)==null?void 0:R.button;const{onViewportChangeStart:M}=H.getState(),P=Kt(_.transform);L.current=!0,V.current=P,((B=_.sourceEvent)==null?void 0:B.type)==="mousedown"&&H.setState({paneDragging:!0}),M==null||M(P),t==null||t(_.sourceEvent,P)})},[k,t]),g.useEffect(()=>{k&&(d&&!L.current?k.on("zoom",null):d||k.on("zoom",_=>{var P;const{onViewportChange:M}=H.getState();if(H.setState({transform:[_.transform.x,_.transform.y,_.transform.k]}),j.current=!!(r&&Ur(f,b.current??0)),(e||M)&&!((P=_.sourceEvent)!=null&&P.internal)){const R=Kt(_.transform);M==null||M(R),e==null||e(_.sourceEvent,R)}}))},[d,k,e,f,r]),g.useEffect(()=>{k&&k.on("end",_=>{if(!_.sourceEvent||_.sourceEvent.internal)return null;const{onViewportChangeEnd:M}=H.getState();if(L.current=!1,H.setState({paneDragging:!1}),r&&Ur(f,b.current??0)&&!j.current&&r(_.sourceEvent),j.current=!1,(n||M)&&Ef(V.current,_.transform)){const P=Kt(_.transform);V.current=P,clearTimeout(T.current),T.current=setTimeout(()=>{M==null||M(P),n==null||n(_.sourceEvent,P)},s?150:0)}})},[k,s,f,n,r]),g.useEffect(()=>{k&&k.filter(_=>{const M=N||o,P=i&&_.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&_.button===1&&_.type==="mousedown"&&(ot(_,"react-flow__node")||ot(_,"react-flow__edge")))return!0;if(!f&&!M&&!s&&!u&&!i||d||!u&&_.type==="dblclick"||ot(_,v)&&_.type==="wheel"||ot(_,x)&&(_.type!=="wheel"||s&&_.type==="wheel"&&!N)||!i&&_.ctrlKey&&_.type==="wheel"||!M&&!s&&!P&&_.type==="wheel"||!f&&(_.type==="mousedown"||_.type==="touchstart")||Array.isArray(f)&&!f.includes(_.button)&&_.type==="mousedown")return!1;const R=Array.isArray(f)&&f.includes(_.button)||!_.button||_.button<=1;return(!_.ctrlKey||_.type==="wheel")&&R})},[d,k,o,i,s,u,f,l,N]),C.createElement("div",{className:"react-flow__renderer",ref:z,style:fr},S)},Af=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Cf(){const{userSelectionActive:e,userSelectionRect:t}=J(Af,se);return e&&t?C.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Zr(e,t){const n=t.parentNode||t.parentId,r=e.find(o=>o.id===n);if(r){const o=t.position.x+t.width-r.width,i=t.position.y+t.height-r.height;if(o>0||i>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,o>0&&(r.style.width+=o),i>0&&(r.style.height+=i),t.position.x<0){const s=Math.abs(t.position.x);r.position.x=r.position.x-s,r.style.width+=s,t.position.x=0}if(t.position.y<0){const s=Math.abs(t.position.y);r.position.y=r.position.y-s,r.style.height+=s,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function ms(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const i=e.filter(a=>a.id===o.id);if(i.length===0)return r.push(o),r;const s={...o};for(const a of i)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position<"u"&&(s.position=a.position),typeof a.positionAbsolute<"u"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&Zr(r,s);break}case"dimensions":{typeof a.dimensions<"u"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle<"u"&&(s.style={...s.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&Zr(r,s);break}case"remove":return r}return r.push(s),r},n)}function gs(e,t){return ms(e,t)}function kf(e,t){return ms(e,t)}const ze=(e,t)=>({id:e,type:"select",selected:t});function it(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(ze(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(ze(r.id,!1))),n},[])}const $n=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},$f=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),ps=g.memo(({isSelecting:e,selectionMode:t=Pt.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:l,children:f})=>{const h=g.useRef(null),m=re(),w=g.useRef(0),y=g.useRef(0),E=g.useRef(),{userSelectionActive:p,elementsSelectable:S,dragging:v}=J($f,se),x=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),w.current=0,y.current=0},T=I=>{i==null||i(I),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},H=I=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){I.preventDefault();return}s==null||s(I)},L=a?I=>a(I):void 0,j=I=>{const{resetSelectedElements:d,domNode:N}=m.getState();if(E.current=N==null?void 0:N.getBoundingClientRect(),!S||!e||I.button!==0||I.target!==h.current||!E.current)return;const{x:b,y:$}=Pe(I,E.current);d(),m.setState({userSelectionRect:{width:0,height:0,startX:b,startY:$,x:b,y:$}}),r==null||r(I)},z=I=>{const{userSelectionRect:d,nodeInternals:N,edges:b,transform:$,onNodesChange:D,onEdgesChange:_,nodeOrigin:M,getNodes:P}=m.getState();if(!e||!E.current||!d)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const R=Pe(I,E.current),B=d.startX??0,O=d.startY??0,Y={...d,x:R.x<B?R.x:B,y:R.y<O?R.y:O,width:Math.abs(R.x-B),height:Math.abs(R.y-O)},W=P(),Z=Go(N,Y,$,t===Pt.Partial,!0,M),G=Ko(Z,b).map(K=>K.id),ee=Z.map(K=>K.id);if(w.current!==ee.length){w.current=ee.length;const K=it(W,ee);K.length&&(D==null||D(K))}if(y.current!==G.length){y.current=G.length;const K=it(b,G);K.length&&(_==null||_(K))}m.setState({userSelectionRect:Y})},V=I=>{if(I.button!==0)return;const{userSelectionRect:d}=m.getState();!p&&d&&I.target===h.current&&(T==null||T(I)),m.setState({nodesSelectionActive:w.current>0}),x(),o==null||o(I)},k=I=>{p&&(m.setState({nodesSelectionActive:w.current>0}),o==null||o(I)),x()},F=S&&(e||p);return C.createElement("div",{className:ie(["react-flow__pane",{dragging:v,selection:e}]),onClick:F?void 0:$n(T,h),onContextMenu:$n(H,h),onWheel:$n(L,h),onMouseEnter:F?void 0:c,onMouseDown:F?j:void 0,onMouseMove:F?z:u,onMouseUp:F?V:void 0,onMouseLeave:F?k:l,ref:h,style:fr},f,C.createElement(Cf,null))});ps.displayName="Pane";function ys(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:ys(r,t):!1}function Gr(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Mf(e,t,n,r){return Array.from(e.values()).filter(o=>(o.selected||o.id===r)&&(!o.parentNode||o.parentId||!ys(o,e))&&(o.draggable||t&&typeof o.draggable>"u")).map(o=>{var i,s;return{id:o.id,position:o.position||{x:0,y:0},positionAbsolute:o.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=o.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((s=o.positionAbsolute)==null?void 0:s.y)??0)},delta:{x:0,y:0},extent:o.extent,parentNode:o.parentNode||o.parentId,parentId:o.parentNode||o.parentId,width:o.width,height:o.height,expandParent:o.expandParent}})}function Tf(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function xs(e,t,n,r,o=[0,0],i){const s=Tf(e,e.extent||r);let a=s;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:h,y:m}=ft(f,o).positionAbsolute;a=f&&de(h)&&de(m)&&de(f.width)&&de(f.height)?[[h+e.width*o[0],m+e.height*o[1]],[h+f.width-e.width+e.width*o[0],m+f.height-e.height+e.height*o[1]]]:a}else i==null||i("005",Me.error005()),a=s;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:h,y:m}=ft(f,o).positionAbsolute;a=[[e.extent[0][0]+h,e.extent[0][1]+m],[e.extent[1][0]+h,e.extent[1][1]+m]]}let u={x:0,y:0};if(c){const f=n.get(c);u=ft(f,o).positionAbsolute}const l=a&&a!=="parent"?tr(t,a):t;return{position:{x:l.x-u.x,y:l.y-u.y},positionAbsolute:l}}function Mn({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const Kr=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return i.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-s.left-a.x)/n,y:(u.top-s.top-a.y)/n,...er(c)}})};function At(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function Yn({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",Me.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var l;return(l=r==null?void 0:r.current)==null?void 0:l.blur()})):o([e])}function Rf(){const e=re();return g.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:o,snapToGrid:i}=e.getState(),s=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(s-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:i?o[0]*Math.round(c.x/o[0]):c.x,ySnapped:i?o[1]*Math.round(c.y/o[1]):c.y,...c}},[])}function Tn(e){return(t,n,r)=>e==null?void 0:e(t,r)}function ws({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,selectNodesOnDrag:s}){const a=re(),[c,u]=g.useState(!1),l=g.useRef([]),f=g.useRef({x:null,y:null}),h=g.useRef(0),m=g.useRef(null),w=g.useRef({x:0,y:0}),y=g.useRef(null),E=g.useRef(!1),p=g.useRef(!1),S=g.useRef(!1),v=Rf();return g.useEffect(()=>{if(e!=null&&e.current){const x=pe(e.current),T=({x:j,y:z})=>{const{nodeInternals:V,onNodeDrag:k,onSelectionDrag:F,updateNodePositions:I,nodeExtent:d,snapGrid:N,snapToGrid:b,nodeOrigin:$,onError:D}=a.getState();f.current={x:j,y:z};let _=!1,M={x:0,y:0,x2:0,y2:0};if(l.current.length>1&&d){const R=ar(l.current,$);M=nr(R)}if(l.current=l.current.map(R=>{const B={x:j-R.distance.x,y:z-R.distance.y};b&&(B.x=N[0]*Math.round(B.x/N[0]),B.y=N[1]*Math.round(B.y/N[1]));const O=[[d[0][0],d[0][1]],[d[1][0],d[1][1]]];l.current.length>1&&d&&!R.extent&&(O[0][0]=R.positionAbsolute.x-M.x+d[0][0],O[1][0]=R.positionAbsolute.x+(R.width??0)-M.x2+d[1][0],O[0][1]=R.positionAbsolute.y-M.y+d[0][1],O[1][1]=R.positionAbsolute.y+(R.height??0)-M.y2+d[1][1]);const Y=xs(R,B,V,O,$,D);return _=_||R.position.x!==Y.position.x||R.position.y!==Y.position.y,R.position=Y.position,R.positionAbsolute=Y.positionAbsolute,R}),!_)return;I(l.current,!0,!0),u(!0);const P=o?k:Tn(F);if(P&&y.current){const[R,B]=Mn({nodeId:o,dragItems:l.current,nodeInternals:V});P(y.current,R,B)}},H=()=>{if(!m.current)return;const[j,z]=Vo(w.current,m.current);if(j!==0||z!==0){const{transform:V,panBy:k}=a.getState();f.current.x=(f.current.x??0)-j/V[2],f.current.y=(f.current.y??0)-z/V[2],k({x:j,y:z})&&T(f.current)}h.current=requestAnimationFrame(H)},L=j=>{var $;const{nodeInternals:z,multiSelectionActive:V,nodesDraggable:k,unselectNodesAndEdges:F,onNodeDragStart:I,onSelectionDragStart:d}=a.getState();p.current=!0;const N=o?I:Tn(d);(!s||!i)&&!V&&o&&(($=z.get(o))!=null&&$.selected||F()),o&&i&&s&&Yn({id:o,store:a,nodeRef:e});const b=v(j);if(f.current=b,l.current=Mf(z,k,b,o),N&&l.current){const[D,_]=Mn({nodeId:o,dragItems:l.current,nodeInternals:z});N(j.sourceEvent,D,_)}};if(t)x.on(".drag",null);else{const j=jc().on("start",z=>{const{domNode:V,nodeDragThreshold:k}=a.getState();k===0&&L(z),S.current=!1;const F=v(z);f.current=F,m.current=(V==null?void 0:V.getBoundingClientRect())||null,w.current=Pe(z.sourceEvent,m.current)}).on("drag",z=>{var I,d;const V=v(z),{autoPanOnNodeDrag:k,nodeDragThreshold:F}=a.getState();if(z.sourceEvent.type==="touchmove"&&z.sourceEvent.touches.length>1&&(S.current=!0),!S.current){if(!E.current&&p.current&&k&&(E.current=!0,H()),!p.current){const N=V.xSnapped-(((I=f==null?void 0:f.current)==null?void 0:I.x)??0),b=V.ySnapped-(((d=f==null?void 0:f.current)==null?void 0:d.y)??0);Math.sqrt(N*N+b*b)>F&&L(z)}(f.current.x!==V.xSnapped||f.current.y!==V.ySnapped)&&l.current&&p.current&&(y.current=z.sourceEvent,w.current=Pe(z.sourceEvent,m.current),T(V))}}).on("end",z=>{if(!(!p.current||S.current)&&(u(!1),E.current=!1,p.current=!1,cancelAnimationFrame(h.current),l.current)){const{updateNodePositions:V,nodeInternals:k,onNodeDragStop:F,onSelectionDragStop:I}=a.getState(),d=o?F:Tn(I);if(V(l.current,!1,!1),d){const[N,b]=Mn({nodeId:o,dragItems:l.current,nodeInternals:k});d(z.sourceEvent,N,b)}}}).filter(z=>{const V=z.target;return!z.button&&(!n||!Gr(V,`.${n}`,e))&&(!r||Gr(V,r,e))});return x.call(j),()=>{x.on(".drag",null)}}}},[e,t,n,r,i,a,o,s,v]),c}function vs(){const e=re();return g.useCallback(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:i,getNodes:s,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:l}=e.getState(),f=s().filter(S=>S.selected&&(S.draggable||l&&typeof S.draggable>"u")),h=a?c[0]:5,m=a?c[1]:5,w=n.isShiftPressed?4:1,y=n.x*h*w,E=n.y*m*w,p=f.map(S=>{if(S.positionAbsolute){const v={x:S.positionAbsolute.x+y,y:S.positionAbsolute.y+E};a&&(v.x=c[0]*Math.round(v.x/c[0]),v.y=c[1]*Math.round(v.y/c[1]));const{positionAbsolute:x,position:T}=xs(S,v,r,o,void 0,u);S.position=T,S.positionAbsolute=x}return S});i(p,!0,!1)},[])}const dt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ct=e=>{const t=({id:n,type:r,data:o,xPos:i,yPos:s,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:l,onMouseEnter:f,onMouseMove:h,onMouseLeave:m,onContextMenu:w,onDoubleClick:y,style:E,className:p,isDraggable:S,isSelectable:v,isConnectable:x,isFocusable:T,selectNodesOnDrag:H,sourcePosition:L,targetPosition:j,hidden:z,resizeObserver:V,dragHandle:k,zIndex:F,isParent:I,noDragClassName:d,noPanClassName:N,initialized:b,disableKeyboardA11y:$,ariaLabel:D,rfId:_,hasHandleBounds:M})=>{const P=re(),R=g.useRef(null),B=g.useRef(null),O=g.useRef(L),Y=g.useRef(j),W=g.useRef(r),Z=v||S||l||f||h||m,G=vs(),ee=At(n,P.getState,f),K=At(n,P.getState,h),he=At(n,P.getState,m),ue=At(n,P.getState,w),me=At(n,P.getState,y),fe=Q=>{const{nodeDragThreshold:X}=P.getState();if(v&&(!H||!S||X>0)&&Yn({id:n,store:P,nodeRef:R}),l){const ce=P.getState().nodeInternals.get(n);ce&&l(Q,{...ce})}},ne=Q=>{if(!Vn(Q)&&!$)if(Oo.includes(Q.key)&&v){const X=Q.key==="Escape";Yn({id:n,store:P,unselect:X,nodeRef:R})}else S&&u&&Object.prototype.hasOwnProperty.call(dt,Q.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${Q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`}),G({x:dt[Q.key].x,y:dt[Q.key].y,isShiftPressed:Q.shiftKey}))};g.useEffect(()=>()=>{B.current&&(V==null||V.unobserve(B.current),B.current=null)},[]),g.useEffect(()=>{if(R.current&&!z){const Q=R.current;(!b||!M||B.current!==Q)&&(B.current&&(V==null||V.unobserve(B.current)),V==null||V.observe(Q),B.current=Q)}},[z,b,M]),g.useEffect(()=>{const Q=W.current!==r,X=O.current!==L,ce=Y.current!==j;R.current&&(Q||X||ce)&&(Q&&(W.current=r),X&&(O.current=L),ce&&(Y.current=j),P.getState().updateNodeDimensions([{id:n,nodeElement:R.current,forceUpdate:!0}]))},[n,r,L,j]);const ve=ws({nodeRef:R,disabled:z||!S,noDragClassName:d,handleSelector:k,nodeId:n,isSelectable:v,selectNodesOnDrag:H});return z?null:C.createElement("div",{className:ie(["react-flow__node",`react-flow__node-${r}`,{[N]:S},p,{selected:u,selectable:v,parent:I,dragging:ve}]),ref:R,style:{zIndex:F,transform:`translate(${a}px,${c}px)`,pointerEvents:Z?"all":"none",visibility:b?"visible":"hidden",...E},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ee,onMouseMove:K,onMouseLeave:he,onContextMenu:ue,onClick:fe,onDoubleClick:me,onKeyDown:T?ne:void 0,tabIndex:T?0:void 0,role:T?"button":void 0,"aria-describedby":$?void 0:`${ls}-${_}`,"aria-label":D},C.createElement(Xu,{value:n},C.createElement(e,{id:n,data:o,type:r,xPos:i,yPos:s,selected:u,isConnectable:x,sourcePosition:L,targetPosition:j,dragging:ve,dragHandle:k,zIndex:F})))};return t.displayName="NodeWrapper",g.memo(t)};const zf=e=>{const t=e.getNodes().filter(n=>n.selected);return{...ar(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Df({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=re(),{width:o,height:i,x:s,y:a,transformString:c,userSelectionActive:u}=J(zf,se),l=vs(),f=g.useRef(null);if(g.useEffect(()=>{var w;n||(w=f.current)==null||w.focus({preventScroll:!0})},[n]),ws({nodeRef:f}),u||!o||!i)return null;const h=e?w=>{const y=r.getState().getNodes().filter(E=>E.selected);e(w,y)}:void 0,m=w=>{Object.prototype.hasOwnProperty.call(dt,w.key)&&l({x:dt[w.key].x,y:dt[w.key].y,isShiftPressed:w.shiftKey})};return C.createElement("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},C.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:o,height:i,top:a,left:s}}))}var If=g.memo(Df);const Pf=e=>e.nodesSelectionActive,bs=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:l,selectionKeyCode:f,selectionOnDrag:h,selectionMode:m,onSelectionStart:w,onSelectionEnd:y,multiSelectionKeyCode:E,panActivationKeyCode:p,zoomActivationKeyCode:S,elementsSelectable:v,zoomOnScroll:x,zoomOnPinch:T,panOnScroll:H,panOnScrollSpeed:L,panOnScrollMode:j,zoomOnDoubleClick:z,panOnDrag:V,defaultViewport:k,translateExtent:F,minZoom:I,maxZoom:d,preventScrolling:N,onSelectionContextMenu:b,noWheelClassName:$,noPanClassName:D,disableKeyboardA11y:_})=>{const M=J(Pf),P=Ht(f),R=Ht(p),B=R||V,O=R||H,Y=P||h&&B!==!0;return bf({deleteKeyCode:a,multiSelectionKeyCode:E}),C.createElement(Nf,{onMove:c,onMoveStart:u,onMoveEnd:l,onPaneContextMenu:i,elementsSelectable:v,zoomOnScroll:x,zoomOnPinch:T,panOnScroll:O,panOnScrollSpeed:L,panOnScrollMode:j,zoomOnDoubleClick:z,panOnDrag:!P&&B,defaultViewport:k,translateExtent:F,minZoom:I,maxZoom:d,zoomActivationKeyCode:S,preventScrolling:N,noWheelClassName:$,noPanClassName:D},C.createElement(ps,{onSelectionStart:w,onSelectionEnd:y,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:B,isSelecting:!!Y,selectionMode:m},e,M&&C.createElement(If,{onSelectionContextMenu:b,noPanClassName:D,disableKeyboardA11y:_})))};bs.displayName="FlowRenderer";var Hf=g.memo(bs);function Ff(e){return J(g.useCallback(n=>e?Go(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Lf(e){const t={input:Ct(e.input||ss),default:Ct(e.default||Xn),output:Ct(e.output||as),group:Ct(e.group||lr)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=Ct(e[i]||Xn),o),n);return{...t,...r}}const jf=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},Vf=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),_s=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:i,onError:s}=J(Vf,se),a=Ff(e.onlyRenderVisibleElements),c=g.useRef(),u=g.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const l=new ResizeObserver(f=>{const h=f.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));i(h)});return c.current=l,l},[]);return g.useEffect(()=>()=>{var l;(l=c==null?void 0:c.current)==null||l.disconnect()},[]),C.createElement("div",{className:"react-flow__nodes",style:fr},a.map(l=>{var T,H,L;let f=l.type||"default";e.nodeTypes[f]||(s==null||s("003",Me.error003(f)),f="default");const h=e.nodeTypes[f]||e.nodeTypes.default,m=!!(l.draggable||t&&typeof l.draggable>"u"),w=!!(l.selectable||o&&typeof l.selectable>"u"),y=!!(l.connectable||n&&typeof l.connectable>"u"),E=!!(l.focusable||r&&typeof l.focusable>"u"),p=e.nodeExtent?tr(l.positionAbsolute,e.nodeExtent):l.positionAbsolute,S=(p==null?void 0:p.x)??0,v=(p==null?void 0:p.y)??0,x=jf({x:S,y:v,width:l.width??0,height:l.height??0,origin:e.nodeOrigin});return C.createElement(h,{key:l.id,id:l.id,className:l.className,style:l.style,type:f,data:l.data,sourcePosition:l.sourcePosition||q.Bottom,targetPosition:l.targetPosition||q.Top,hidden:l.hidden,xPos:S,yPos:v,xPosOrigin:x.x,yPosOrigin:x.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!l.selected,isDraggable:m,isSelectable:w,isConnectable:y,isFocusable:E,resizeObserver:u,dragHandle:l.dragHandle,zIndex:((T=l[te])==null?void 0:T.z)??0,isParent:!!((H=l[te])!=null&&H.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!l.width&&!!l.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:l.ariaLabel,hasHandleBounds:!!((L=l[te])!=null&&L.handleBounds)})}))};_s.displayName="NodeRenderer";var Bf=g.memo(_s);const Of=(e,t,n)=>n===q.Left?e-t:n===q.Right?e+t:e,qf=(e,t,n)=>n===q.Top?e-t:n===q.Bottom?e+t:e,Qr="react-flow__edgeupdater",Jr=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a})=>C.createElement("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:ie([Qr,`${Qr}-${a}`]),cx:Of(t,r,e),cy:qf(n,r,e),r,stroke:"transparent",fill:"transparent"}),Xf=()=>!0;var st=e=>{const t=({id:n,className:r,type:o,data:i,onClick:s,onEdgeDoubleClick:a,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:h,labelBgStyle:m,labelBgPadding:w,labelBgBorderRadius:y,style:E,source:p,target:S,sourceX:v,sourceY:x,targetX:T,targetY:H,sourcePosition:L,targetPosition:j,elementsSelectable:z,hidden:V,sourceHandleId:k,targetHandleId:F,onContextMenu:I,onMouseEnter:d,onMouseMove:N,onMouseLeave:b,reconnectRadius:$,onReconnect:D,onReconnectStart:_,onReconnectEnd:M,markerEnd:P,markerStart:R,rfId:B,ariaLabel:O,isFocusable:Y,isReconnectable:W,pathOptions:Z,interactionWidth:G,disableKeyboardA11y:ee})=>{const K=g.useRef(null),[he,ue]=g.useState(!1),[me,fe]=g.useState(!1),ne=re(),ve=g.useMemo(()=>`url('#${On(R,B)}')`,[R,B]),Q=g.useMemo(()=>`url('#${On(P,B)}')`,[P,B]);if(V)return null;const X=oe=>{var be;const{edges:ge,addSelectedEdges:Ve,unselectNodesAndEdges:Be,multiSelectionActive:Oe}=ne.getState(),Ae=ge.find(bt=>bt.id===n);Ae&&(z&&(ne.setState({nodesSelectionActive:!1}),Ae.selected&&Oe?(Be({nodes:[],edges:[Ae]}),(be=K.current)==null||be.blur()):Ve([n])),s&&s(oe,Ae))},ce=Nt(n,ne.getState,a),Fe=Nt(n,ne.getState,I),wt=Nt(n,ne.getState,d),Ke=Nt(n,ne.getState,N),Qe=Nt(n,ne.getState,b),Ne=(oe,ge)=>{if(oe.button!==0)return;const{edges:Ve,isValidConnection:Be}=ne.getState(),Oe=ge?S:p,Ae=(ge?F:k)||null,be=ge?"target":"source",bt=Be||Xf,xn=ge,_t=Ve.find(qe=>qe.id===n);fe(!0),_==null||_(oe,_t,be);const wn=qe=>{fe(!1),M==null||M(qe,_t,be)};ts({event:oe,handleId:Ae,nodeId:Oe,onConnect:qe=>D==null?void 0:D(_t,qe),isTarget:xn,getState:ne.getState,setState:ne.setState,isValidConnection:bt,edgeUpdaterType:be,onReconnectEnd:wn})},Je=oe=>Ne(oe,!0),Le=oe=>Ne(oe,!1),je=()=>ue(!0),et=()=>ue(!1),tt=!z&&!s,vt=oe=>{var ge;if(!ee&&Oo.includes(oe.key)&&z){const{unselectNodesAndEdges:Ve,addSelectedEdges:Be,edges:Oe}=ne.getState();oe.key==="Escape"?((ge=K.current)==null||ge.blur(),Ve({edges:[Oe.find(be=>be.id===n)]})):Be([n])}};return C.createElement("g",{className:ie(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:c,animated:u,inactive:tt,updating:he}]),onClick:X,onDoubleClick:ce,onContextMenu:Fe,onMouseEnter:wt,onMouseMove:Ke,onMouseLeave:Qe,onKeyDown:Y?vt:void 0,tabIndex:Y?0:void 0,role:Y?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":O===null?void 0:O||`Edge from ${p} to ${S}`,"aria-describedby":Y?`${us}-${B}`:void 0,ref:K},!me&&C.createElement(e,{id:n,source:p,target:S,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:h,labelBgStyle:m,labelBgPadding:w,labelBgBorderRadius:y,data:i,style:E,sourceX:v,sourceY:x,targetX:T,targetY:H,sourcePosition:L,targetPosition:j,sourceHandleId:k,targetHandleId:F,markerStart:ve,markerEnd:Q,pathOptions:Z,interactionWidth:G}),W&&C.createElement(C.Fragment,null,(W==="source"||W===!0)&&C.createElement(Jr,{position:L,centerX:v,centerY:x,radius:$,onMouseDown:Je,onMouseEnter:je,onMouseOut:et,type:"source"}),(W==="target"||W===!0)&&C.createElement(Jr,{position:j,centerX:T,centerY:H,radius:$,onMouseDown:Le,onMouseEnter:je,onMouseOut:et,type:"target"})))};return t.displayName="EdgeWrapper",g.memo(t)};function Yf(e){const t={default:st(e.default||un),straight:st(e.bezier||sr),step:st(e.step||or),smoothstep:st(e.step||yn),simplebezier:st(e.simplebezier||rr)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=st(e[i]||un),o),n);return{...t,...r}}function eo(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,o=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,s=(n==null?void 0:n.height)||t.height;switch(e){case q.Top:return{x:r+i/2,y:o};case q.Right:return{x:r+i,y:o+s/2};case q.Bottom:return{x:r+i/2,y:o+s};case q.Left:return{x:r,y:o+s/2}}}function to(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Uf=(e,t,n,r,o,i)=>{const s=eo(n,e,t),a=eo(i,r,o);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function Wf({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:i,width:s,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const l=nr({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:s/c[2],height:a/c[2]}),f=Math.max(0,Math.min(l.x2,u.x2)-Math.max(l.x,u.x)),h=Math.max(0,Math.min(l.y2,u.y2)-Math.max(l.y,u.y));return Math.ceil(f*h)>0}function no(e){var r,o,i,s,a;const t=((r=e==null?void 0:e[te])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const Zf=[{level:0,isMaxLevel:!0,edges:[]}];function Gf(e,t,n=!1){let r=-1;const o=e.reduce((s,a)=>{var l,f;const c=de(a.zIndex);let u=c?a.zIndex:0;if(n){const h=t.get(a.target),m=t.get(a.source),w=a.selected||(h==null?void 0:h.selected)||(m==null?void 0:m.selected),y=Math.max(((l=m==null?void 0:m[te])==null?void 0:l.z)||0,((f=h==null?void 0:h[te])==null?void 0:f.z)||0,1e3);u=(c?a.zIndex:0)+(w?y:0)}return s[u]?s[u].push(a):s[u]=[a],r=u>r?u:r,s},{}),i=Object.entries(o).map(([s,a])=>{const c=+s;return{edges:a,level:c,isMaxLevel:c===r}});return i.length===0?Zf:i}function Kf(e,t,n){const r=J(g.useCallback(o=>e?o.edges.filter(i=>{const s=t.get(i.source),a=t.get(i.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&Wf({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return Gf(r,t,n)}const Qf=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Jf=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),ro={[yt.Arrow]:Qf,[yt.ArrowClosed]:Jf};function ed(e){const t=re();return g.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(ro,e)?ro[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",Me.error009(e)),null)},[e])}const td=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=ed(t);return c?C.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},C.createElement(c,{color:n,strokeWidth:s})):null},nd=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=On(s,t);r.includes(a)||(o.push({id:a,color:s.color||e,...s}),r.push(a))}}),o),[]).sort((o,i)=>o.id.localeCompare(i.id))},Es=({defaultColor:e,rfId:t})=>{const n=J(g.useCallback(nd({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((i,s)=>i.id!==o[s].id)));return C.createElement("defs",null,n.map(r=>C.createElement(td,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};Es.displayName="MarkerDefinitions";var rd=g.memo(Es);const od=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Ss=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:l,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:m,onReconnectEnd:w,reconnectRadius:y,children:E,disableKeyboardA11y:p})=>{const{edgesFocusable:S,edgesUpdatable:v,elementsSelectable:x,width:T,height:H,connectionMode:L,nodeInternals:j,onError:z}=J(od,se),V=Kf(t,j,n);return T?C.createElement(C.Fragment,null,V.map(({level:k,edges:F,isMaxLevel:I})=>C.createElement("svg",{key:k,style:{zIndex:k},width:T,height:H,className:"react-flow__edges react-flow__container"},I&&C.createElement(rd,{defaultColor:e,rfId:r}),C.createElement("g",null,F.map(d=>{const[N,b,$]=no(j.get(d.source)),[D,_,M]=no(j.get(d.target));if(!$||!M)return null;let P=d.type||"default";o[P]||(z==null||z("011",Me.error011(P)),P="default");const R=o[P]||o.default,B=L===He.Strict?_.target:(_.target??[]).concat(_.source??[]),O=to(b.source,d.sourceHandle),Y=to(B,d.targetHandle),W=(O==null?void 0:O.position)||q.Bottom,Z=(Y==null?void 0:Y.position)||q.Top,G=!!(d.focusable||S&&typeof d.focusable>"u"),ee=d.reconnectable||d.updatable,K=typeof h<"u"&&(ee||v&&typeof ee>"u");if(!O||!Y)return z==null||z("008",Me.error008(O,d)),null;const{sourceX:he,sourceY:ue,targetX:me,targetY:fe}=Uf(N,O,W,D,Y,Z);return C.createElement(R,{key:d.id,id:d.id,className:ie([d.className,i]),type:P,data:d.data,selected:!!d.selected,animated:!!d.animated,hidden:!!d.hidden,label:d.label,labelStyle:d.labelStyle,labelShowBg:d.labelShowBg,labelBgStyle:d.labelBgStyle,labelBgPadding:d.labelBgPadding,labelBgBorderRadius:d.labelBgBorderRadius,style:d.style,source:d.source,target:d.target,sourceHandleId:d.sourceHandle,targetHandleId:d.targetHandle,markerEnd:d.markerEnd,markerStart:d.markerStart,sourceX:he,sourceY:ue,targetX:me,targetY:fe,sourcePosition:W,targetPosition:Z,elementsSelectable:x,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:l,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:m,onReconnectEnd:w,reconnectRadius:y,rfId:r,ariaLabel:d.ariaLabel,isFocusable:G,isReconnectable:K,pathOptions:"pathOptions"in d?d.pathOptions:void 0,interactionWidth:d.interactionWidth,disableKeyboardA11y:p})})))),E):null};Ss.displayName="EdgeRenderer";var sd=g.memo(Ss);const id=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ad({children:e}){const t=J(id);return C.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function cd(e){const t=ur(),n=g.useRef(!1);g.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const ld={[q.Left]:q.Right,[q.Right]:q.Left,[q.Top]:q.Bottom,[q.Bottom]:q.Top},Ns=({nodeId:e,handleType:t,style:n,type:r=De.Bezier,CustomComponent:o,connectionStatus:i})=>{var H,L,j;const{fromNode:s,handleId:a,toX:c,toY:u,connectionMode:l}=J(g.useCallback(z=>({fromNode:z.nodeInternals.get(e),handleId:z.connectionHandleId,toX:(z.connectionPosition.x-z.transform[0])/z.transform[2],toY:(z.connectionPosition.y-z.transform[1])/z.transform[2],connectionMode:z.connectionMode}),[e]),se),f=(H=s==null?void 0:s[te])==null?void 0:H.handleBounds;let h=f==null?void 0:f[t];if(l===He.Loose&&(h=h||(f==null?void 0:f[t==="source"?"target":"source"])),!s||!h)return null;const m=a?h.find(z=>z.id===a):h[0],w=m?m.x+m.width/2:(s.width??0)/2,y=m?m.y+m.height/2:s.height??0,E=(((L=s.positionAbsolute)==null?void 0:L.x)??0)+w,p=(((j=s.positionAbsolute)==null?void 0:j.y)??0)+y,S=m==null?void 0:m.position,v=S?ld[S]:null;if(!S||!v)return null;if(o)return C.createElement(o,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:m,fromX:E,fromY:p,toX:c,toY:u,fromPosition:S,toPosition:v,connectionStatus:i});let x="";const T={sourceX:E,sourceY:p,sourcePosition:S,targetX:c,targetY:u,targetPosition:v};return r===De.Bezier?[x]=Wo(T):r===De.Step?[x]=Bn({...T,borderRadius:0}):r===De.SmoothStep?[x]=Bn(T):r===De.SimpleBezier?[x]=Uo(T):x=`M${E},${p} ${c},${u}`,C.createElement("path",{d:x,fill:"none",className:"react-flow__connection-path",style:n})};Ns.displayName="ConnectionLine";const ud=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function fd({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:i,nodesConnectable:s,width:a,height:c,connectionStatus:u}=J(ud,se);return!(o&&i&&a&&s)?null:C.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},C.createElement("g",{className:ie(["react-flow__connection",u])},C.createElement(Ns,{nodeId:o,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function oo(e,t){return g.useRef(null),re(),g.useMemo(()=>t(e),[e])}const As=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:i,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:m,onSelectionContextMenu:w,onSelectionStart:y,onSelectionEnd:E,connectionLineType:p,connectionLineStyle:S,connectionLineComponent:v,connectionLineContainerStyle:x,selectionKeyCode:T,selectionOnDrag:H,selectionMode:L,multiSelectionKeyCode:j,panActivationKeyCode:z,zoomActivationKeyCode:V,deleteKeyCode:k,onlyRenderVisibleElements:F,elementsSelectable:I,selectNodesOnDrag:d,defaultViewport:N,translateExtent:b,minZoom:$,maxZoom:D,preventScrolling:_,defaultMarkerColor:M,zoomOnScroll:P,zoomOnPinch:R,panOnScroll:B,panOnScrollSpeed:O,panOnScrollMode:Y,zoomOnDoubleClick:W,panOnDrag:Z,onPaneClick:G,onPaneMouseEnter:ee,onPaneMouseMove:K,onPaneMouseLeave:he,onPaneScroll:ue,onPaneContextMenu:me,onEdgeContextMenu:fe,onEdgeMouseEnter:ne,onEdgeMouseMove:ve,onEdgeMouseLeave:Q,onReconnect:X,onReconnectStart:ce,onReconnectEnd:Fe,reconnectRadius:wt,noDragClassName:Ke,noWheelClassName:Qe,noPanClassName:Ne,elevateEdgesOnSelect:Je,disableKeyboardA11y:Le,nodeOrigin:je,nodeExtent:et,rfId:tt})=>{const vt=oo(e,Lf),oe=oo(t,Yf);return cd(i),C.createElement(Hf,{onPaneClick:G,onPaneMouseEnter:ee,onPaneMouseMove:K,onPaneMouseLeave:he,onPaneContextMenu:me,onPaneScroll:ue,deleteKeyCode:k,selectionKeyCode:T,selectionOnDrag:H,selectionMode:L,onSelectionStart:y,onSelectionEnd:E,multiSelectionKeyCode:j,panActivationKeyCode:z,zoomActivationKeyCode:V,elementsSelectable:I,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:P,zoomOnPinch:R,zoomOnDoubleClick:W,panOnScroll:B,panOnScrollSpeed:O,panOnScrollMode:Y,panOnDrag:Z,defaultViewport:N,translateExtent:b,minZoom:$,maxZoom:D,onSelectionContextMenu:w,preventScrolling:_,noDragClassName:Ke,noWheelClassName:Qe,noPanClassName:Ne,disableKeyboardA11y:Le},C.createElement(ad,null,C.createElement(sd,{edgeTypes:oe,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:F,onEdgeContextMenu:fe,onEdgeMouseEnter:ne,onEdgeMouseMove:ve,onEdgeMouseLeave:Q,onReconnect:X,onReconnectStart:ce,onReconnectEnd:Fe,reconnectRadius:wt,defaultMarkerColor:M,noPanClassName:Ne,elevateEdgesOnSelect:!!Je,disableKeyboardA11y:Le,rfId:tt},C.createElement(fd,{style:S,type:p,component:v,containerStyle:x})),C.createElement("div",{className:"react-flow__edgelabel-renderer"}),C.createElement(Bf,{nodeTypes:vt,onNodeClick:s,onNodeDoubleClick:c,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:m,selectNodesOnDrag:d,onlyRenderVisibleElements:F,noPanClassName:Ne,noDragClassName:Ke,disableKeyboardA11y:Le,nodeOrigin:je,nodeExtent:et,rfId:tt})))};As.displayName="GraphView";var dd=g.memo(As);const Un=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Te={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Un,nodeExtent:Un,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:He.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Lu,isValidConnection:void 0},hd=()=>Qi((e,t)=>({...Te,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:kn(n,r,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",i=typeof r<"u",s=o?kn(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),l=c==null?void 0:c.querySelector(".react-flow__viewport");if(!l)return;const f=window.getComputedStyle(l),{m22:h}=new window.DOMMatrixReadOnly(f.transform),m=n.reduce((y,E)=>{const p=o.get(E.id);if(p!=null&&p.hidden)o.set(p.id,{...p,[te]:{...p[te],handleBounds:void 0}});else if(p){const S=er(E.nodeElement);!!(S.width&&S.height&&(p.width!==S.width||p.height!==S.height||E.forceUpdate))&&(o.set(p.id,{...p,[te]:{...p[te],handleBounds:{source:Kr(".source",E.nodeElement,h,u),target:Kr(".target",E.nodeElement,h,u)}},...S}),y.push({id:p.id,type:"dimensions",dimensions:S}))}return y},[]);ds(o,u);const w=s||i&&!s&&hs(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:w}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,o=!1)=>{const{triggerNodeChanges:i}=t(),s=n.map(a=>{const c={id:a.id,type:"position",dragging:o};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});i(s)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(i){const u=gs(n,a()),l=kn(u,o,s,c);e({nodeInternals:l})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(c=>ze(c,!0)):(s=it(i(),n),a=it(o,[])),Gt({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(c=>ze(c,!0)):(s=it(o,n),a=it(i(),[])),Gt({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:i}=t(),s=n||i(),a=r||o,c=s.map(l=>(l.selected=!1,ze(l.id,!1))),u=a.map(l=>ze(l.id,!1));Gt({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r==null||r.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r==null||r.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(a=>a.selected).map(a=>ze(a.id,!1)),s=n.filter(a=>a.selected).map(a=>ze(a.id,!1));Gt({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=tr(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:o,height:i,d3Zoom:s,d3Selection:a,translateExtent:c}=t();if(!s||!a||!n.x&&!n.y)return!1;const u=Ie.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),l=[[0,0],[o,i]],f=s==null?void 0:s.constrain()(u,l,c);return s.transform(a,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:Te.connectionNodeId,connectionHandleId:Te.connectionHandleId,connectionHandleType:Te.connectionHandleType,connectionStatus:Te.connectionStatus,connectionStartHandle:Te.connectionStartHandle,connectionEndHandle:Te.connectionEndHandle}),reset:()=>e({...Te})}),Object.is),Cs=({children:e})=>{const t=g.useRef(null);return t.current||(t.current=hd()),C.createElement(Tu,{value:t.current},e)};Cs.displayName="ReactFlowProvider";const ks=({children:e})=>g.useContext(pn)?C.createElement(C.Fragment,null,e):C.createElement(Cs,null,e);ks.displayName="ReactFlowWrapper";const md={input:ss,default:Xn,output:as,group:lr},gd={default:un,straight:sr,step:or,smoothstep:yn,simplebezier:rr},pd=[0,0],yd=[15,15],xd={x:0,y:0,zoom:1},wd={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},$s=g.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i=md,edgeTypes:s=gd,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:f,onMoveEnd:h,onConnect:m,onConnectStart:w,onConnectEnd:y,onClickConnectStart:E,onClickConnectEnd:p,onNodeMouseEnter:S,onNodeMouseMove:v,onNodeMouseLeave:x,onNodeContextMenu:T,onNodeDoubleClick:H,onNodeDragStart:L,onNodeDrag:j,onNodeDragStop:z,onNodesDelete:V,onEdgesDelete:k,onSelectionChange:F,onSelectionDragStart:I,onSelectionDrag:d,onSelectionDragStop:N,onSelectionContextMenu:b,onSelectionStart:$,onSelectionEnd:D,connectionMode:_=He.Strict,connectionLineType:M=De.Bezier,connectionLineStyle:P,connectionLineComponent:R,connectionLineContainerStyle:B,deleteKeyCode:O="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:W=!1,selectionMode:Z=Pt.Full,panActivationKeyCode:G="Space",multiSelectionKeyCode:ee=ln()?"Meta":"Control",zoomActivationKeyCode:K=ln()?"Meta":"Control",snapToGrid:he=!1,snapGrid:ue=yd,onlyRenderVisibleElements:me=!1,selectNodesOnDrag:fe=!0,nodesDraggable:ne,nodesConnectable:ve,nodesFocusable:Q,nodeOrigin:X=pd,edgesFocusable:ce,edgesUpdatable:Fe,elementsSelectable:wt,defaultViewport:Ke=xd,minZoom:Qe=.5,maxZoom:Ne=2,translateExtent:Je=Un,preventScrolling:Le=!0,nodeExtent:je,defaultMarkerColor:et="#b1b1b7",zoomOnScroll:tt=!0,zoomOnPinch:vt=!0,panOnScroll:oe=!1,panOnScrollSpeed:ge=.5,panOnScrollMode:Ve=Ue.Free,zoomOnDoubleClick:Be=!0,panOnDrag:Oe=!0,onPaneClick:Ae,onPaneMouseEnter:be,onPaneMouseMove:bt,onPaneMouseLeave:xn,onPaneScroll:_t,onPaneContextMenu:wn,children:dr,onEdgeContextMenu:qe,onEdgeDoubleClick:zs,onEdgeMouseEnter:Ds,onEdgeMouseMove:Is,onEdgeMouseLeave:Ps,onEdgeUpdate:Hs,onEdgeUpdateStart:Fs,onEdgeUpdateEnd:Ls,onReconnect:js,onReconnectStart:Vs,onReconnectEnd:Bs,reconnectRadius:Os=10,edgeUpdaterRadius:qs=10,onNodesChange:Xs,onEdgesChange:Ys,noDragClassName:Us="nodrag",noWheelClassName:Ws="nowheel",noPanClassName:hr="nopan",fitView:Zs=!1,fitViewOptions:Gs,connectOnClick:Ks=!0,attributionPosition:Qs,proOptions:Js,defaultEdgeOptions:ei,elevateNodesOnSelect:ti=!0,elevateEdgesOnSelect:ni=!1,disableKeyboardA11y:mr=!1,autoPanOnConnect:ri=!0,autoPanOnNodeDrag:oi=!0,connectionRadius:si=20,isValidConnection:ii,onError:ai,style:ci,id:gr,nodeDragThreshold:li,...ui},fi)=>{const vn=gr||"1";return C.createElement("div",{...ui,style:{...ci,...wd},ref:fi,className:ie(["react-flow",o]),"data-testid":"rf__wrapper",id:gr},C.createElement(ks,null,C.createElement(dd,{onInit:u,onMove:l,onMoveStart:f,onMoveEnd:h,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:S,onNodeMouseMove:v,onNodeMouseLeave:x,onNodeContextMenu:T,onNodeDoubleClick:H,nodeTypes:i,edgeTypes:s,connectionLineType:M,connectionLineStyle:P,connectionLineComponent:R,connectionLineContainerStyle:B,selectionKeyCode:Y,selectionOnDrag:W,selectionMode:Z,deleteKeyCode:O,multiSelectionKeyCode:ee,panActivationKeyCode:G,zoomActivationKeyCode:K,onlyRenderVisibleElements:me,selectNodesOnDrag:fe,defaultViewport:Ke,translateExtent:Je,minZoom:Qe,maxZoom:Ne,preventScrolling:Le,zoomOnScroll:tt,zoomOnPinch:vt,zoomOnDoubleClick:Be,panOnScroll:oe,panOnScrollSpeed:ge,panOnScrollMode:Ve,panOnDrag:Oe,onPaneClick:Ae,onPaneMouseEnter:be,onPaneMouseMove:bt,onPaneMouseLeave:xn,onPaneScroll:_t,onPaneContextMenu:wn,onSelectionContextMenu:b,onSelectionStart:$,onSelectionEnd:D,onEdgeContextMenu:qe,onEdgeDoubleClick:zs,onEdgeMouseEnter:Ds,onEdgeMouseMove:Is,onEdgeMouseLeave:Ps,onReconnect:js??Hs,onReconnectStart:Vs??Fs,onReconnectEnd:Bs??Ls,reconnectRadius:Os??qs,defaultMarkerColor:et,noDragClassName:Us,noWheelClassName:Ws,noPanClassName:hr,elevateEdgesOnSelect:ni,rfId:vn,disableKeyboardA11y:mr,nodeOrigin:X,nodeExtent:je}),C.createElement(lf,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:w,onConnectEnd:y,onClickConnectStart:E,onClickConnectEnd:p,nodesDraggable:ne,nodesConnectable:ve,nodesFocusable:Q,edgesFocusable:ce,edgesUpdatable:Fe,elementsSelectable:wt,elevateNodesOnSelect:ti,minZoom:Qe,maxZoom:Ne,nodeExtent:je,onNodesChange:Xs,onEdgesChange:Ys,snapToGrid:he,snapGrid:ue,connectionMode:_,translateExtent:Je,connectOnClick:Ks,defaultEdgeOptions:ei,fitView:Zs,fitViewOptions:Gs,onNodesDelete:V,onEdgesDelete:k,onNodeDragStart:L,onNodeDrag:j,onNodeDragStop:z,onSelectionDrag:d,onSelectionDragStart:I,onSelectionDragStop:N,noPanClassName:hr,nodeOrigin:X,rfId:vn,autoPanOnConnect:ri,autoPanOnNodeDrag:oi,onError:ai,connectionRadius:si,isValidConnection:ii,nodeDragThreshold:li}),C.createElement(af,{onSelectionChange:F}),dr,C.createElement(zu,{proOptions:Js,position:Qs}),C.createElement(mf,{rfId:vn,disableKeyboardA11y:mr})))});$s.displayName="ReactFlow";function Ms(e){return t=>{const[n,r]=g.useState(t),o=g.useCallback(i=>r(s=>e(i,s)),[]);return[n,r,o]}}const vd=Ms(gs),bd=Ms(kf);function _d(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},C.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Ed(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},C.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Sd(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},C.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Nd(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Ad(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Mt=({children:e,className:t,...n})=>C.createElement("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n},e);Mt.displayName="ControlButton";const Cd=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Ts=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:u,children:l,position:f="bottom-left"})=>{const h=re(),[m,w]=g.useState(!1),{isInteractive:y,minZoomReached:E,maxZoomReached:p}=J(Cd,se),{zoomIn:S,zoomOut:v,fitView:x}=ur();if(g.useEffect(()=>{w(!0)},[]),!m)return null;const T=()=>{S(),i==null||i()},H=()=>{v(),s==null||s()},L=()=>{x(o),a==null||a()},j=()=>{h.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)};return C.createElement(jo,{className:ie(["react-flow__controls",u]),position:f,style:e,"data-testid":"rf__controls"},t&&C.createElement(C.Fragment,null,C.createElement(Mt,{onClick:T,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:p},C.createElement(_d,null)),C.createElement(Mt,{onClick:H,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:E},C.createElement(Ed,null))),n&&C.createElement(Mt,{className:"react-flow__controls-fitview",onClick:L,title:"fit view","aria-label":"fit view"},C.createElement(Sd,null)),r&&C.createElement(Mt,{className:"react-flow__controls-interactive",onClick:j,title:"toggle interactivity","aria-label":"toggle interactivity"},y?C.createElement(Ad,null):C.createElement(Nd,null)),l)};Ts.displayName="Controls";var kd=g.memo(Ts),xe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(xe||(xe={}));function $d({color:e,dimensions:t,lineWidth:n}){return C.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Md({color:e,radius:t}){return C.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Td={[xe.Dots]:"#91919a",[xe.Lines]:"#eee",[xe.Cross]:"#e2e2e2"},Rd={[xe.Dots]:1,[xe.Lines]:1,[xe.Cross]:6},zd=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Rs({id:e,variant:t=xe.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=2,color:s,style:a,className:c}){const u=g.useRef(null),{transform:l,patternId:f}=J(zd,se),h=s||Td[t],m=r||Rd[t],w=t===xe.Dots,y=t===xe.Cross,E=Array.isArray(n)?n:[n,n],p=[E[0]*l[2]||1,E[1]*l[2]||1],S=m*l[2],v=y?[S,S]:p,x=w?[S/i,S/i]:[v[0]/i,v[1]/i];return C.createElement("svg",{className:ie(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},C.createElement("pattern",{id:f+e,x:l[0]%p[0],y:l[1]%p[1],width:p[0],height:p[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${x[0]},-${x[1]})`},w?C.createElement(Md,{color:h,radius:S/i}):C.createElement($d,{dimensions:v,color:h,lineWidth:o})),C.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}Rs.displayName="Background";var Dd=g.memo(Rs);function Id({url:e,onEnded:t,autoPlay:n=!1}){const r=g.useRef(null);return g.useEffect(()=>{r.current&&(r.current.src=e,n&&r.current.play())},[e,n]),A.jsx("div",{className:"relative w-full aspect-w-16 aspect-h-9",children:A.jsx("video",{ref:r,className:"w-full h-full rounded-lg object-cover",controls:!0,onEnded:t})})}function Pd({isOpen:e,onClose:t,onSuccess:n,projectId:r,nodeId:o,isAnswer:i,editingItem:s}){const[a,c]=g.useState(""),[u,l]=g.useState(""),[f,h]=g.useState(null),[m,w]=g.useState(!1),[y,E]=g.useState("");g.useEffect(()=>{s&&(s.type==="question"?c(s.data.question||""):l(s.data.text||""))},[s]);const p=async S=>{S.preventDefault(),w(!0),E("");try{const v=new FormData;i?(v.append("text",u),f&&v.append("video",f),await We.addAnswer(r,o,v)):(v.append("question",a),o?(v.append("parent_id",o),v.append("is_sub_question","true")):(v.append("parent_id",""),v.append("is_sub_question","false")),await We.addNode(r,v)),n(),t()}catch(v){console.error("Error:",v),E(v.message||"Failed to add question/answer")}finally{w(!1)}};return A.jsx(at,{appear:!0,show:e,as:g.Fragment,children:A.jsxs(ct,{as:"div",className:"relative z-10",onClose:t,children:[A.jsx(at.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:A.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),A.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:A.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:A.jsx(at.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:A.jsxs(ct.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[A.jsx(ct.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 mb-4",children:i?"Add Answer":"Add Question"}),A.jsxs("form",{onSubmit:p,className:"space-y-4",children:[i?A.jsxs(A.Fragment,{children:[A.jsxs("div",{children:[A.jsx("label",{htmlFor:"text",className:"block text-sm font-medium text-gray-700",children:"Answer Text"}),A.jsx("textarea",{id:"text",value:u,onChange:S=>l(S.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",rows:3,required:!0})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"video",className:"block text-sm font-medium text-gray-700",children:"Video (Optional)"}),A.jsx("input",{type:"file",id:"video",accept:"video/*",onChange:S=>{var v;return h(((v=S.target.files)==null?void 0:v[0])||null)},className:`mt-1 block w-full text-sm text-gray-500
                            file:mr-4 file:py-2 file:px-4
                            file:rounded-md file:border-0
                            file:text-sm file:font-semibold
                            file:bg-blue-50 file:text-blue-700
                            hover:file:bg-blue-100`})]})]}):A.jsxs("div",{children:[A.jsx("label",{htmlFor:"question",className:"block text-sm font-medium text-gray-700",children:"Question"}),A.jsx("input",{type:"text",id:"question",value:a,onChange:S=>c(S.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:!0})]}),y&&A.jsx("div",{className:"rounded-md bg-red-50 p-4",children:A.jsx("div",{className:"text-sm text-red-700",children:y})}),A.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[A.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:m,children:"Cancel"}),A.jsx("button",{type:"submit",className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:m,children:m?A.jsxs("span",{className:"flex items-center",children:[A.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[A.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),A.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Adding..."]}):"Add"})]})]})]})})})})]})})}function Hd({isOpen:e,onClose:t,projectId:n}){const[r,o]=g.useState(""),[i,s]=g.useState([]),[a,c]=g.useState(""),[u,l]=g.useState(!1),[f,h]=g.useState(""),[m,w]=g.useState(!1);g.useEffect(()=>{e&&n&&y()},[e,n]);const y=async()=>{try{const v=await We.getEmbedCode(n);o(v.embed_code),s(v.allowed_domains)}catch(v){h(v.message||"Failed to fetch embed code")}},E=async v=>{if(v.preventDefault(),!!a.trim()){l(!0),h("");try{const x=new FormData;x.append("domain",a.trim()),await We.addAllowedDomain(n,x),c(""),await y()}catch(x){h(x.message||"Failed to add domain")}finally{l(!1)}}},p=async v=>{l(!0),h("");try{await We.removeAllowedDomain(n,v),await y()}catch(x){h(x.message||"Failed to remove domain")}finally{l(!1)}},S=async()=>{try{await navigator.clipboard.writeText(r),w(!0),setTimeout(()=>w(!1),2e3)}catch{h("Failed to copy to clipboard")}};return A.jsx(at,{appear:!0,show:e,as:g.Fragment,children:A.jsxs(ct,{as:"div",className:"relative z-50",onClose:t,children:[A.jsx(at.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:A.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),A.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:A.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:A.jsx(at.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:A.jsxs(ct.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white p-6 shadow-xl transition-all",children:[A.jsxs("div",{className:"flex items-center justify-between mb-6",children:[A.jsx(ct.Title,{as:"h3",className:"text-lg font-semibold text-gray-900",children:"Embed Settings"}),A.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:A.jsx(gi,{className:"h-6 w-6"})})]}),A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{children:[A.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Allowed Domains"}),A.jsxs("form",{onSubmit:E,className:"flex space-x-3 mb-4",children:[A.jsx("input",{type:"text",value:a,onChange:v=>c(v.target.value),placeholder:"example.com",className:"flex-1 min-w-0 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),A.jsx("button",{type:"submit",disabled:u||!a.trim(),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Domain"})]}),A.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:i.length===0?A.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No domains added yet. Add a domain to restrict where this widget can be embedded."}):A.jsx("ul",{className:"divide-y divide-gray-200",children:i.map(v=>A.jsxs("li",{className:"flex justify-between items-center py-2",children:[A.jsx("span",{className:"text-sm text-gray-600",children:v}),A.jsx("button",{onClick:()=>p(v),disabled:u,className:"text-sm text-red-600 hover:text-red-800 disabled:opacity-50",children:"Remove"})]},v))})})]}),A.jsxs("div",{children:[A.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Embed Code"}),A.jsxs("div",{className:"relative",children:[A.jsx("pre",{className:"bg-gray-50 rounded-lg p-4 text-sm font-mono text-gray-700 whitespace-pre-wrap break-all",children:r}),A.jsx("button",{onClick:S,className:"absolute top-2 right-2 p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100",title:"Copy to clipboard",children:m?A.jsx(wi,{className:"h-5 w-5 text-green-500"}):A.jsx(bi,{className:"h-5 w-5"})})]})]}),f&&A.jsx("div",{className:"rounded-md bg-red-50 p-4",children:A.jsx("div",{className:"text-sm text-red-700",children:f})})]})]})})})})]})})}const so={stroke:"#6366f1",strokeWidth:3,strokeDasharray:"5,5"},Fd=({data:e})=>A.jsxs("div",{className:`relative bg-white rounded-lg shadow-lg p-4 ${e.isMain?"min-w-[400px]":"min-w-[300px]"}`,children:[A.jsx(xt,{type:"target",position:q.Top,id:`${e.id}-target`,style:{background:"#6366f1",width:"10px",height:"10px"},className:"!top-0"}),(e.isMain||e.video_url)&&A.jsx("div",{className:"aspect-w-16 aspect-h-9 mb-4",children:A.jsx(Id,{url:e.isMain?e.url||"":e.video_url||""})}),A.jsx("div",{className:"mt-4",children:e.isMain?A.jsx(A.Fragment,{children:e.question?A.jsxs(A.Fragment,{children:[A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsx("h3",{className:"font-medium text-gray-900",children:e.question}),A.jsx("button",{onClick:e.onEditQuestion,className:"text-blue-600 hover:text-blue-700",children:A.jsx(bn,{className:"h-5 w-5"})})]}),A.jsxs("button",{onClick:e.onAddAnswer,className:"mt-4 btn btn-secondary w-full flex items-center justify-center",children:[A.jsx(Bt,{className:"h-5 w-5 mr-2"}),"Add Answer"]})]}):A.jsxs("button",{onClick:e.onAddQuestion,className:"btn btn-primary w-full flex items-center justify-center",children:[A.jsx(Bt,{className:"h-5 w-5 mr-2"}),"Add Question"]})}):e.isAnswer?A.jsxs(A.Fragment,{children:[A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsx("h4",{className:"font-medium text-gray-700",children:e.text}),A.jsx("button",{onClick:e.onEditAnswer,className:"text-blue-600 hover:text-blue-700",children:A.jsx(bn,{className:"h-5 w-5"})})]}),A.jsxs("button",{onClick:e.onAddQuestion,className:"mt-4 btn btn-primary w-full flex items-center justify-center",children:[A.jsx(Bt,{className:"h-5 w-5 mr-2"}),"Add Question"]})]}):A.jsxs(A.Fragment,{children:[A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsx("h3",{className:"font-medium text-gray-900",children:e.question}),A.jsx("button",{onClick:e.onEditQuestion,className:"text-blue-600 hover:text-blue-700",children:A.jsx(bn,{className:"h-5 w-5"})})]}),A.jsxs("button",{onClick:e.onAddAnswer,className:"mt-4 btn btn-secondary w-full flex items-center justify-center",children:[A.jsx(Bt,{className:"h-5 w-5 mr-2"}),"Add Answer"]})]})}),A.jsx(xt,{type:"source",position:q.Bottom,id:`${e.id}-source`,style:{background:"#10B981",width:"10px",height:"10px"},className:"!bottom-0"})]}),Ld={videoNode:Fd},Bd=()=>{const{id:e}=hi(),t=mi(),[n,r]=g.useState(null),[o,i]=vd([]),[s,a]=bd([]),[c,u]=g.useState(!0),[l,f]=g.useState(""),[h,m]=g.useState(!1),[w,y]=g.useState(null),[E,p]=g.useState(!1),[S,v]=g.useState(null),[x,T]=g.useState(!1),H=g.useCallback((k,F,I=!1,d=0,N=0,b=[],$=[])=>{if(!k)return N;const D=I?`answer-${k.id}`:k.id,_=d*400,M=N;console.log("Processing node:",{id:D,parentId:F,isAnswer:I,level:d,question:k.question,text:k.text,isSubQuestion:k.is_sub_question}),b.push({id:D,type:"videoNode",position:{x:_,y:M},data:{id:D,isMain:F===null,isAnswer:I,url:k.url,video_url:k.video_url,question:k.question,text:k.text,onAddQuestion:()=>{y(D),p(!1),v(null),m(!0)},onEditQuestion:()=>{y(D),p(!1),v({type:"question",data:k}),m(!0)},onAddAnswer:()=>{y(D),p(!0),v(null),m(!0)},onEditAnswer:()=>{y(F),p(!0),v({type:"answer",data:k}),m(!0)}},className:`border-2 ${F===null?"border-indigo-500":I?"border-blue-400":"border-green-400"}`}),F&&$.push({id:`${F}-${D}`,source:F,target:D,sourceHandle:`${F}-source`,targetHandle:`${D}-target`,type:"smoothstep",animated:!0,label:I?"Answer":"Question",labelBgStyle:{fill:"#F3F4F6"},labelStyle:{fill:"#374151",fontWeight:500},style:{...so,stroke:I?"#6366f1":"#10B981"},markerEnd:{type:yt.ArrowClosed,color:I?"#6366f1":"#10B981",width:20,height:20}});let P=N+250;return!I&&k.answers&&k.answers.length>0&&k.answers.forEach(R=>{if(P=H(R,D,!0,d+1,P,b,$),R.question){const B={id:`question-${R.id}`,question:R.question,answers:[],sub_answers:[],parent_id:`answer-${R.id}`,is_sub_question:!0};P=H(B,`answer-${R.id}`,!1,d+2,P,b,$)}R.sub_answers&&R.sub_answers.length>0&&R.sub_answers.forEach(B=>{P=H({...B,parent_id:R.question?`question-${R.id}`:`answer-${R.id}`,is_sub_question:!0},R.question?`question-${R.id}`:`answer-${R.id}`,!0,d+3,P,b,$)})}),P},[]),L=g.useCallback(k=>{const F=[],I=[];if(!k.nodes||k.nodes.length===0)return F.push({id:"main",type:"videoNode",position:{x:0,y:0},data:{id:"main",isMain:!0,url:k.main_video_url,question:null,onAddQuestion:()=>{y(null),p(!1),v(null),m(!0)}},className:"border-2 border-indigo-500"}),{nodes:F,edges:I};const d=k.nodes.find(N=>!N.parent_id);return H(d||k.nodes[0],null,!1,0,0,F,I),{nodes:F,edges:I}},[H]),j=g.useCallback(async()=>{var k,F;if(e)try{const I=await We.getProject(e);r(I);const{nodes:d,edges:N}=L(I);i(d),a(N)}catch(I){console.error("Error fetching project:",I),f(((F=(k=I.response)==null?void 0:k.data)==null?void 0:F.detail)||"Failed to load project")}finally{u(!1)}},[e,L,i,a]),z=g.useCallback(async()=>{m(!1),v(null),await j()},[j]),V=async()=>{var k,F;if(!(!n||!window.confirm("Are you sure you want to delete this project?")))try{await We.deleteProject(n.id),t("/",{replace:!0})}catch(I){f(((F=(k=I.response)==null?void 0:k.data)==null?void 0:F.detail)||"Failed to delete project")}};return g.useEffect(()=>{j()},[j]),c?A.jsx(Vt,{children:A.jsx("div",{className:"text-center",children:"Loading project..."})}):l?A.jsx(Vt,{children:A.jsx("div",{className:"rounded-md bg-red-50 p-4",children:A.jsx("div",{className:"text-sm text-red-700",children:l})})}):n?A.jsx(Vt,{children:A.jsxs("div",{className:"container mx-auto px-4 py-8",children:[A.jsxs("div",{className:"flex justify-between items-center mb-8",children:[A.jsxs("div",{className:"flex items-center space-x-4",children:[A.jsx("button",{onClick:()=>t("/dashboard"),className:"p-2 rounded-full hover:bg-gray-100",children:A.jsx(yi,{className:"h-6 w-6 text-gray-600"})}),A.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n==null?void 0:n.name})]}),A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsxs("button",{onClick:()=>T(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[A.jsx(Ei,{className:"h-5 w-5 mr-2"}),"Embed Code"]}),A.jsxs("button",{onClick:V,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[A.jsx(Ai,{className:"h-5 w-5 mr-2"}),"Delete Project"]})]})]}),A.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[A.jsx("div",{className:"h-[calc(100vh-12rem)] border border-gray-200 rounded-lg bg-gray-50",children:A.jsxs($s,{nodes:o,edges:s,nodeTypes:Ld,fitView:!0,minZoom:.1,maxZoom:1.5,attributionPosition:"bottom-left",connectionMode:He.Loose,defaultEdgeOptions:{type:"smoothstep",animated:!0,style:so,markerEnd:{type:yt.ArrowClosed,color:"#6366f1",width:20,height:20}},children:[A.jsx(Dd,{}),A.jsx(kd,{})]})}),A.jsx(Pd,{isOpen:h,onClose:()=>{m(!1),v(null)},onSuccess:z,projectId:(n==null?void 0:n.id)||"",nodeId:w||void 0,isAnswer:E,editingItem:S}),A.jsx(Hd,{isOpen:x,onClose:()=>T(!1),projectId:(n==null?void 0:n.id)||""})]})]})}):A.jsx(Vt,{children:A.jsx("div",{className:"text-center",children:"Project not found"})})};export{Bd as default};
//# sourceMappingURL=ProjectDetail-CzG0b-ZA.js.map
